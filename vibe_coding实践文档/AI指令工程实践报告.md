# DreamAIChat · AI指令工程实践报告

> 版本：2025-12-03  
> 主导者：邢浩哲（产品 Owner / Prompt Engineer）  
> 协作伙伴：GPT-5.1 Codex（AI Coding Agent）

---

## 1. 协作角色与边界

| 角色 | 职责定位 | 说明 |
| --- | --- | --- |
| 邢浩哲（我） | 产品愿景 & Prompt 策略总设计师 | 负责需求拆解、质量标准、Prompt 结构、结果验收，保证指令工程“有章可循” |
| GPT-5.1 Codex | 工程执行助手 | 根据高约束 Prompt 产出代码/文档草稿，快速迭代实现 |

核心原则：**“我负责定义问题与验收标准，AI 负责实现并解释实现。”**

---

## 2. Prompt 工程体系化建设

### 2.1 Prompt 模板（以我为主体）

```
[角色约束]：我提供身份、上下游边界，明确 AI 只能在我定义的范围内执行
[目标声明]：一次只做一件事，列出验收标准
[上下文链接]：引用现有文档/代码位置，避免 AI 盲写
[技术约束]：语言、框架、资源路径、命名规范
[交付格式]：必须输出的章节/列表/代码块格式
[迭代钩子]：鼓励 AI 在不确定时先提问
```

### 2.2 Prompt 迭代路径（典型流程）

1. **初始探索**：抛出问题场景 + 目标，观察 AI 的理解范围  
2. **约束收敛**：针对第一次输出中的偏差，追加“禁止 / 必须”说明  
3. **验证回路**：要求 AI 自检（例如列出风险、测试步骤）  
4. **上线前复核**：我对关键代码逐行审核，必要时补充“为什么这么写”说明

---

## 3. 代表性 Prompt 案例（Android/Kotlin 方向）

| 功能场景 | Prompt 精要（我发出的指令） | AI 产出 | 迭代要点 |
| --- | --- | --- | --- |
| 聊天输入区改版 | “请把 fragment_chat.xml 的发送/图片按钮改为无背景 ImageButton，尺寸 56dp，图标放 strings 表，部署指南需同步说明” | 完成布局 + strings + 文档变更 | 强调“部署指南同步”后，AI 才把替换步骤写入 §9 |
| 对话图谱回填 | “ConversationGraphFragment 点击后必须加载 MessageRepository，拼接‘用户/AI’标签文本后写回 pendingPrompt，并自动返回 ChatFragment” | Fragment + ViewModel 改造完成 | 我追问“摘要为何仍是‘暂无摘要’”，AI 复查后加入完整拼接逻辑 |
| 退出登录历史丢失 | “请找出退出登录后历史记录丢失的根因，禁止删库，定位到仓库层级并解释修复方案” | 定位到 `insertOrUpdateUserWithId` 的 REPLACE，引申级联删除 | 我要求“写入故障排查文档”，AI 顺带补文档与更新日志 |
| LLM 联网诊断 | “后端需要一个 /api/diagnostics/providers 接口，自检 baseUrl/API Key/DNS/TCP，部署指南追加排查章节” | 新 Controller + 文档 §14 | 在 Prompt 中明确“输出示例 + 排查表”，最终文档涵盖表格 & 建议顺序 |

> **说明**：我从不直接让 AI “自由发挥”，而是把资源路径、命名约定和验收格式写进 Prompt，形成可复用的“工程化话术”。

---

## 4. Prompt 迭代与质控实录

### 4.1 多轮对话回顾

1. **首次指令**：描述目标（如“模板对话自动回填输入框”）  
2. **AI 回复**：给出技术实现思路 + 代码草稿  
3. **我的追问**：若发现遗漏（例如“没有切回聊天页”），立即追加约束  
4. **AI 修订**：补齐逻辑 + 自测步骤  
5. **验收**：我在本地运行验证，若仍有问题，再次发起精准 Prompt

### 4.2 质量守门流程

- **静态检查**：我要求 AI 自查潜在 NPE/线程问题，并输出验证 checklist  
- **文档同步**：所有结构性改动必须说明相关文档位置（部署指南、API 说明等）  
- **追溯记录**：把 bug 根因、修复方案写回《故障排查及解决文档》，形成组织记忆  
- **Prompt 版本化**：将高质量指令记录在本报告，后续团队成员可以复用

---

## 5. Prompt 工程实践总结

1. **以我为主的指令风格**：每一条 Prompt 都强调“我是 Owner”，AI 只做执行与解释。  
2. **上下文精准引用**：通过路径、文件名、行文格式，让 AI 直接落地现有代码。  
3. **需求-实现-文档三连闭环**：修改任何功能时，Prompt 同时要求代码 + 文档更新，形成标准流程。  
4. **问题导向复盘**：遇到 bug（如历史丢失）时，我的 Prompt 先问“为什么”，再问“怎么修”，避免头痛医头。  
5. **Prompt 档案库**：把有效指令整理成结构化记录，支撑后续同学在训练营中展现 Prompt Engineering 能力。

---

## 6. 结语

在 DreamAIChat 项目中，我通过“工程化、逻辑化、标准化”的 Prompt 体系，让 AI 成为真正可信的协作者。未来我也会持续迭代这套话术与流程，将其沉淀为团队可共享的资产。

