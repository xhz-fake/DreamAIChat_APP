# 依赖问题排查指南

## 问题：Cannot resolve symbol 'HttpLoggingInterceptor' 等错误

### 原因分析

这些错误通常表示：
1. **Gradle 同步未完成** - 依赖还没有下载
2. **IDE 缓存问题** - Android Studio 的索引没有更新
3. **依赖下载失败** - 网络问题导致依赖没有下载成功

### 解决步骤（按顺序执行）

#### 步骤 1：强制同步 Gradle

1. **方法一（推荐）**：
   - 点击 Android Studio 顶部工具栏的 "Sync Project with Gradle Files" 图标（大象图标）
   - 或点击菜单 `File` → `Sync Project with Gradle Files`

2. **方法二**：
   - 打开右侧的 `Gradle` 面板（如果没有，点击 `View` → `Tool Windows` → `Gradle`）
   - 点击刷新按钮（🔄）

3. **等待同步完成**：
   - 查看底部状态栏，应该显示 "Gradle build finished"
   - 如果显示错误，查看 `Build` 面板了解详情

#### 步骤 2：清理并重新构建

如果同步后仍有问题：

1. **清理项目**：
   - 点击菜单 `Build` → `Clean Project`
   - 等待清理完成

2. **重新构建**：
   - 点击菜单 `Build` → `Rebuild Project`
   - 这会重新编译整个项目

#### 步骤 3：清理 IDE 缓存

如果上述步骤还不行：

1. **清理缓存**：
   - 点击菜单 `File` → `Invalidate Caches / Restart`
   - 在弹出的对话框中选择 `Invalidate and Restart`
   - Android Studio 会重启

2. **重启后再次同步**：
   - 等待 Android Studio 完全启动
   - 再次执行步骤 1 同步 Gradle

#### 步骤 4：检查依赖是否下载成功

1. **查看 Gradle 面板**：
   - 打开右侧 `Gradle` 面板
   - 展开 `DreamAIChat_APP` → `app` → `Tasks` → `android`
   - 双击 `dependencies` 任务
   - 查看输出，确认依赖是否下载成功

2. **检查本地仓库**：
   - 依赖通常下载到：`C:\Users\你的用户名\.gradle\caches\modules-2\files-2.1\`
   - 如果这个文件夹存在且很大，说明依赖已下载

#### 步骤 5：手动验证依赖

如果还是不行，可以尝试：

1. **检查 build.gradle.kts**：
   - 确认所有依赖都已添加
   - 确认版本号正确

2. **检查网络连接**：
   - 确保网络连接正常
   - 如果使用代理，确保代理配置正确

3. **尝试离线模式**：
   - 如果网络有问题，可以暂时启用离线模式
   - `File` → `Settings` → `Build, Execution, Deployment` → `Gradle`
   - 取消勾选 "Offline work"

### 验证依赖是否加载成功

同步完成后，检查：

1. **打开 RetrofitClient.java**
2. **检查导入语句**：
   - `import okhttp3.OkHttpClient;` 应该没有红色波浪线
   - `import okhttp3.logging.HttpLoggingInterceptor;` 应该没有红色波浪线
   - `import retrofit2.Retrofit;` 应该没有红色波浪线

3. **检查类名**：
   - `HttpLoggingInterceptor` 应该可以正常识别
   - `OkHttpClient` 应该可以正常识别
   - `Retrofit` 应该可以正常识别

### 如果还是不行

1. **检查 settings.gradle.kts**：
   - 确保仓库配置正确
   - 确保包含 `google()` 和 `mavenCentral()`

2. **检查网络代理**：
   - 如果使用公司网络，可能需要配置代理
   - `File` → `Settings` → `Appearance & Behavior` → `System Settings` → `HTTP Proxy`

3. **查看详细错误**：
   - 打开 `Build` 面板
   - 查看具体的错误信息
   - 根据错误信息搜索解决方案

### 常见错误及解决方案

#### 错误 1：网络超时

**错误信息**：`Read timed out` 或 `Connection timed out`

**解决方案**：
1. 检查网络连接
2. 配置国内镜像源（已在 settings.gradle.kts 中配置）
3. 增加超时时间

#### 错误 2：依赖版本冲突

**错误信息**：`Conflict with dependency` 或 `Multiple versions found`

**解决方案**：
1. 检查 `libs.versions.toml` 中的版本号
2. 确保所有相关依赖使用相同版本
3. 运行 `./gradlew dependencies` 查看依赖树

#### 错误 3：仓库访问失败

**错误信息**：`Could not resolve dependency` 或 `Repository not found`

**解决方案**：
1. 检查 `settings.gradle.kts` 中的仓库配置
2. 尝试使用不同的镜像源
3. 检查防火墙设置

### 快速检查清单

- [ ] Gradle 同步已完成（底部状态栏显示 "Gradle build finished"）
- [ ] 已执行 `Build` → `Clean Project`
- [ ] 已执行 `Build` → `Rebuild Project`
- [ ] 已执行 `File` → `Invalidate Caches / Restart`
- [ ] 检查了 `Build` 面板，没有错误
- [ ] 检查了 `Gradle` 面板，依赖任务执行成功
- [ ] `RetrofitClient.java` 中的导入语句没有红色错误

### 最后的建议

如果以上所有步骤都尝试了还是不行：

1. **检查 Android Studio 版本**：
   - 确保使用最新版本的 Android Studio
   - 旧版本可能不支持某些依赖

2. **检查 JDK 版本**：
   - 确保使用 JDK 11 或更高版本
   - `File` → `Project Structure` → `SDK Location` → `JDK location`

3. **重新导入项目**：
   - 关闭 Android Studio
   - 删除 `.idea` 文件夹（项目根目录）
   - 重新打开项目

4. **查看官方文档**：
   - Retrofit: https://square.github.io/retrofit/
   - OkHttp: https://square.github.io/okhttp/

