# DreamAIChat_APP éƒ¨ç½²æ–‡æ¡£



## 1. ç¯å¢ƒè¦æ±‚

### 1.1 å¼€å‘ç¯å¢ƒ

- **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS, æˆ– Linux
- **JDK**: JDK 11 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Android Studio**: Arctic Fox (2020.3.1) æˆ–æ›´é«˜ç‰ˆæœ¬
- **Gradle**: 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆé¡¹ç›®å·²åŒ…å« Gradle Wrapperï¼‰
- **Android SDK**: API 21 (Android 5.0) æˆ–æ›´é«˜ç‰ˆæœ¬

### 1.2 ç¡¬ä»¶è¦æ±‚

- **å†…å­˜**: è‡³å°‘ 8GB RAMï¼ˆæ¨è 16GBï¼‰
- **å­˜å‚¨ç©ºé—´**: è‡³å°‘ 10GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥ä»¥ä¸‹è½½ä¾èµ–



## 2. é¡¹ç›®ç»“æ„

> å½“å‰å¯ç”¨ä»£ç ä½äº `D:\ProgramFiles\CodeProjects\Android\projects\DreamAIChat\DreamAIChat_APP`ã€‚
```
DreamAIChat_APP/
â”œâ”€â”€ app/                          # åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/            # Java æºä»£ç 
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ com/example/dreamaichat_app/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ data/    # æ•°æ®å±‚
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ domain/ # é¢†åŸŸå±‚
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ mvi/    # MVI æ¶æ„åŸºç¡€
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ presentation/ # è¡¨ç°å±‚
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ui/     # UI å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ res/            # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ AndroidManifest.xml
â”‚   â”‚   â””â”€â”€ test/               # æµ‹è¯•ä»£ç 
â”‚   â””â”€â”€ build.gradle.kts        # æ¨¡å—æ„å»ºé…ç½®
â”œâ”€â”€ gradle/                     # Gradle é…ç½®
â”‚   â””â”€â”€ libs.versions.toml     # ä¾èµ–ç‰ˆæœ¬ç®¡ç†
â”œâ”€â”€ build.gradle.kts            # é¡¹ç›®æ„å»ºé…ç½®
â”œâ”€â”€ settings.gradle.kts         # é¡¹ç›®è®¾ç½®
â””â”€â”€ gradlew                     # Gradle Wrapper (Unix)
```



## 3. å®‰è£…æ­¥éª¤

### 3.1 å…‹éš†é¡¹ç›®

```bash
# å¦‚æœé¡¹ç›®åœ¨ Git ä»“åº“ä¸­
git clone <repository-url>
cd DreamAIChat_APP
```

### 3.2 é…ç½® Android Studio

1. **æ‰“å¼€é¡¹ç›®**
   - å¯åŠ¨ Android Studio
   - é€‰æ‹© `File` â†’ `Open`
   - é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•

2. **åŒæ­¥ Gradle**
   - Android Studio ä¼šè‡ªåŠ¨æ£€æµ‹é¡¹ç›®å¹¶æç¤ºåŒæ­¥
   - ç‚¹å‡» `Sync Now` æˆ–ç­‰å¾…è‡ªåŠ¨åŒæ­¥å®Œæˆ
   - é¦–æ¬¡åŒæ­¥å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆä¸‹è½½ä¾èµ–ï¼‰

3. **é…ç½® SDK**
   - æ‰“å¼€ `File` â†’ `Project Structure` â†’ `SDK Location`
   - ç¡®ä¿å·²å®‰è£… Android SDK Platform 21 æˆ–æ›´é«˜ç‰ˆæœ¬
   - ç¡®ä¿å·²å®‰è£… Android SDK Build-Tools

### 3.3 é…ç½® API åœ°å€

#### 3.3.1 ä»€ä¹ˆæ˜¯ API åœ°å€ï¼Ÿ

API åœ°å€ï¼ˆä¹Ÿå« Base URLï¼‰æ˜¯æˆ‘ä»¬çš„åç«¯æœåŠ¡å™¨åœ°å€ã€‚å½“åº”ç”¨éœ€è¦è·å–æ•°æ®æˆ–å‘é€æ•°æ®æ—¶ï¼Œä¼šå‘è¿™ä¸ªåœ°å€å‘é€ HTTP è¯·æ±‚ã€‚

**ç®€å•ç†è§£**ï¼š

- å°±åƒä½ å®¶çš„åœ°å€ä¸€æ ·ï¼ŒAPI åœ°å€å‘Šè¯‰åº”ç”¨"å»å“ªé‡Œæ‰¾æ•°æ®"
- ä¾‹å¦‚ï¼š`https://api.example.com/` å°±æ˜¯æœåŠ¡å™¨çš„åœ°å€
- å…·ä½“çš„æ¥å£ï¼ˆå¦‚ç™»å½•ã€å‘é€æ¶ˆæ¯ï¼‰ä¼šåœ¨è¿™ä¸ªåœ°å€åé¢æ·»åŠ è·¯å¾„

#### 3.3.2 é…ç½®æ­¥éª¤

**æ­¥éª¤ 1ï¼šæ‰¾åˆ°é…ç½®æ–‡ä»¶**

1. åœ¨ Android Studio å·¦ä¾§çš„ `Project` é¢æ¿ä¸­ï¼Œæ‰¾åˆ°ä»¥ä¸‹è·¯å¾„ï¼š
   ```
   app â†’ src â†’ main â†’ java â†’ com â†’ example â†’ dreamaichat_app â†’ data â†’ remote â†’ RetrofitClient.java
   ```
2. åŒå‡»æ‰“å¼€ `RetrofitClient.java` æ–‡ä»¶

**æ­¥éª¤ 2ï¼šä¿®æ”¹ BASE_URL**

åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°è¿™ä¸€è¡Œï¼ˆå¤§çº¦åœ¨ç¬¬ 30 è¡Œå·¦å³ï¼‰ï¼š
```java
private static final String BASE_URL = "https://api.example.com/";
```

å°† `https://api.example.com/` æ›¿æ¢ä¸ºä½ çš„å®é™… API åœ°å€ã€‚

**é‡è¦æç¤º**ï¼š

- âœ… åœ°å€å¿…é¡»ä»¥ `http://` æˆ– `https://` å¼€å¤´
- âœ… åœ°å€æœ«å°¾å¿…é¡»æœ‰æ–œæ  `/`
- âœ… ä¸è¦åŒ…å«å…·ä½“çš„æ¥å£è·¯å¾„ï¼ˆå¦‚ `/auth/login`ï¼‰ï¼Œåªå†™åŸºç¡€åœ°å€
- âŒ é”™è¯¯ç¤ºä¾‹ï¼š`api.example.com`ï¼ˆç¼ºå°‘åè®®ï¼‰
- âŒ é”™è¯¯ç¤ºä¾‹ï¼š`https://api.example.com`ï¼ˆç¼ºå°‘æœ«å°¾æ–œæ ï¼‰
- âœ… æ­£ç¡®ç¤ºä¾‹ï¼š`https://api.example.com/`

#### 3.3.3 ä¸åŒåœºæ™¯çš„é…ç½®æ–¹æ³•

**åœºæ™¯ 1ï¼šä½¿ç”¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨**

å¦‚æœä½ åœ¨æœ¬åœ°è¿è¡Œåç«¯æœåŠ¡å™¨ï¼ˆå¦‚ä½¿ç”¨ Spring Bootã€Node.js ç­‰ï¼‰ï¼š

```java
// å¦‚æœä½¿ç”¨ Android æ¨¡æ‹Ÿå™¨ï¼Œä½¿ç”¨ 10.0.2.2 ä»£æ›¿ localhost
private static final String BASE_URL = "http://10.0.2.2:8081/";

// å¦‚æœä½¿ç”¨çœŸæœºè°ƒè¯•ï¼Œä½¿ç”¨ç”µè„‘çš„ IP åœ°å€ï¼ˆåœ¨ cmd ä¸­è¾“å…¥ ipconfig æŸ¥çœ‹ï¼‰
private static final String BASE_URL = "http://192.168.1.100:8081/";
```

**å¦‚ä½•æŸ¥çœ‹ç”µè„‘ IP åœ°å€**ï¼š
- Windowsï¼šæ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆcmdï¼‰ï¼Œè¾“å…¥ `ipconfig`ï¼Œæ‰¾åˆ° "IPv4 åœ°å€"
- Mac/Linuxï¼šæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ `ifconfig`ï¼Œæ‰¾åˆ° "inet" åœ°å€

**åœºæ™¯ 2ï¼šä½¿ç”¨æµ‹è¯•æœåŠ¡å™¨**

å¦‚æœä½ æœ‰æµ‹è¯•ç¯å¢ƒçš„æœåŠ¡å™¨åœ°å€ï¼š

```java
private static final String BASE_URL = "https://test-api.yourcompany.com/";
```

**åœºæ™¯ 3ï¼šä½¿ç”¨ç”Ÿäº§æœåŠ¡å™¨**

æ­£å¼å‘å¸ƒæ—¶ä½¿ç”¨ï¼š

```java
private static final String BASE_URL = "https://api.yourcompany.com/";
```

**åœºæ™¯ 4ï¼šæš‚æ—¶æ²¡æœ‰åç«¯æœåŠ¡å™¨ï¼ˆå¼€å‘æµ‹è¯•ï¼‰**

å¦‚æœä½ è¿˜æ²¡æœ‰åç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥ï¼š

1. **ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®**ï¼ˆæ¨èç”¨äº UI å¼€å‘ï¼‰
   - æš‚æ—¶ä¸ä¿®æ”¹ BASE_URL
   - åœ¨ `LoginUseCase` å’Œ `SendMessageUseCase` ä¸­è¿”å›æ¨¡æ‹Ÿæ•°æ®
   - è¿™æ ·å¯ä»¥å…ˆå®Œæˆç•Œé¢å¼€å‘

2. **ä½¿ç”¨å…¬å…±æµ‹è¯• API**
   - å¯ä»¥ä½¿ç”¨ä¸€äº›å…è´¹çš„æµ‹è¯• API æœåŠ¡
   - ä¾‹å¦‚ï¼š`https://jsonplaceholder.typicode.com/`ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œä¸æ˜¯çœŸå®åŠŸèƒ½ï¼‰

#### 3.3.4 é…ç½®ç¤ºä¾‹

**å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼š

```java
public class RetrofitClient {
    // å¼€å‘ç¯å¢ƒ - æœ¬åœ°æœåŠ¡å™¨
    private static final String BASE_URL = "http://10.0.2.2:8081/";
    
    // æˆ–è€…æµ‹è¯•ç¯å¢ƒ
    // private static final String BASE_URL = "https://test-api.example.com/";
    
    // æˆ–è€…ç”Ÿäº§ç¯å¢ƒ
    // private static final String BASE_URL = "https://api.example.com/";
    
    // ... å…¶ä»–ä»£ç 
}
```

#### 3.3.5 å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ

**æ–¹æ³• 1ï¼šæŸ¥çœ‹æ—¥å¿—**

1. è¿è¡Œåº”ç”¨
2. æ‰“å¼€ Android Studio åº•éƒ¨çš„ `Logcat` é¢æ¿
3. è¿‡æ»¤æ ‡ç­¾ï¼šè¾“å…¥ `OkHttp` æˆ– `Retrofit`
4. å¦‚æœçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„æ—¥å¿—ï¼Œè¯´æ˜é…ç½®æˆåŠŸï¼š
   ```
   D/OkHttp: --> POST https://api.example.com/auth/login
   D/OkHttp: Content-Type: application/json
   ```

**æ–¹æ³• 2ï¼šæµ‹è¯•ç™»å½•åŠŸèƒ½**

1. åœ¨åº”ç”¨ä¸­è¾“å…¥è´¦å·å¯†ç ï¼Œç‚¹å‡»ç™»å½•
2. æŸ¥çœ‹ Logcatï¼š
   - å¦‚æœçœ‹åˆ°ç½‘ç»œè¯·æ±‚æ—¥å¿—ï¼Œè¯´æ˜é…ç½®æ­£ç¡®
   - å¦‚æœçœ‹åˆ°è¿æ¥é”™è¯¯ï¼ˆå¦‚ "Failed to connect"ï¼‰ï¼Œæ£€æŸ¥ï¼š
     - API åœ°å€æ˜¯å¦æ­£ç¡®
     - æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
     - ç½‘ç»œæ˜¯å¦è¿æ¥

#### 3.3.6 å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

**é—®é¢˜ 1ï¼šè¿æ¥å¤±è´¥ï¼ˆConnection refusedï¼‰**

**åŸå› **ï¼š
- API åœ°å€é”™è¯¯
- æœåŠ¡å™¨æœªè¿è¡Œ
- é˜²ç«å¢™é˜»æ­¢è¿æ¥

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ API åœ°å€æ˜¯å¦æ­£ç¡®ï¼ˆåŒ…æ‹¬åè®®ã€ç«¯å£å·ï¼‰
2. ç¡®è®¤åç«¯æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

**é—®é¢˜ 2ï¼š404 Not Found**

**åŸå› **ï¼š
- API è·¯å¾„é”™è¯¯
- æœåŠ¡å™¨ä¸Šæ²¡æœ‰å¯¹åº”çš„æ¥å£

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `ApiService.java` ä¸­çš„æ¥å£è·¯å¾„æ˜¯å¦æ­£ç¡®
2. ä¸åç«¯å¼€å‘äººå‘˜ç¡®è®¤æ¥å£è·¯å¾„

**é—®é¢˜ 3ï¼šSSL è¯ä¹¦é”™è¯¯ï¼ˆä»… HTTPSï¼‰**

**åŸå› **ï¼š
- ä½¿ç”¨äº†è‡ªç­¾åè¯ä¹¦
- è¯ä¹¦è¿‡æœŸ

**è§£å†³æ–¹æ³•**ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰ï¼š
- æš‚æ—¶ä½¿ç”¨ HTTP åè®®ï¼ˆä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰
- æˆ–é…ç½®ä¿¡ä»»æ‰€æœ‰è¯ä¹¦ï¼ˆä»…ç”¨äºå¼€å‘æµ‹è¯•ï¼‰

#### 3.3.7 é…ç½®è®¤è¯ Tokenï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ çš„ API éœ€è¦è®¤è¯ Tokenï¼Œéœ€è¦åœ¨ç™»å½•æˆåŠŸåä¿å­˜ Tokenï¼Œç„¶ååœ¨åç»­è¯·æ±‚ä¸­ä½¿ç”¨ã€‚

**å½“å‰å®ç°**ï¼š
- Token åœ¨ `SendMessageUseCase` ä¸­ä½¿ç”¨
- ç™»å½•æˆåŠŸåï¼ŒToken åº”è¯¥ä¿å­˜åœ¨ `SharedPreferences` æˆ–æ•°æ®åº“ä¸­
- åç»­è¯·æ±‚ä¼šè‡ªåŠ¨å¸¦ä¸Š Token

**å¦‚ä½•é…ç½®**ï¼ˆå¦‚æœ Token ç®¡ç†è¿˜æœªå®ç°ï¼‰ï¼š
1. æš‚æ—¶å¯ä»¥åœ¨ `SendMessageUseCase` ä¸­ç¡¬ç¼–ç æµ‹è¯• Token
2. åç»­ä¼šå®ç°å®Œæ•´çš„ Token ç®¡ç†æœºåˆ¶

#### 3.3.8 ä¸‹ä¸€æ­¥

é…ç½®å®Œ API åœ°å€åï¼š
1. âœ… ä¿å­˜æ–‡ä»¶ï¼ˆCtrl+S æˆ– Cmd+Sï¼‰
2. âœ… åŒæ­¥é¡¹ç›®ï¼ˆç‚¹å‡» Android Studio é¡¶éƒ¨çš„ "Sync Now"ï¼‰
3. âœ… è¿è¡Œåº”ç”¨æµ‹è¯•ç½‘ç»œè¿æ¥
4. âœ… æŸ¥çœ‹ Logcat ç¡®è®¤è¯·æ±‚æ˜¯å¦å‘é€æˆåŠŸ



## 4. Spring Boot åç«¯éƒ¨ç½²ï¼ˆDreamAIChat_backendï¼‰

Android å®¢æˆ·ç«¯å·²ç»ä¸å†ä¾èµ–æ¨¡æ‹Ÿæ•°æ®ï¼Œ`DreamAIChat_backend` æä¾›çœŸå®çš„ç™»å½•ã€å¯¹è¯ã€ä¼šè¯åˆ—è¡¨ç­‰æ¥å£ã€‚æœ¬èŠ‚ç»™å‡ºæœ€å°å¯è¿è¡Œç‰ˆæœ¬çš„æ­å»ºæ­¥éª¤ï¼š

### 4.1 ç¯å¢ƒè¦æ±‚

- JDK 17ï¼ˆå»ºè®®ä½¿ç”¨ Temurin/OpenJDKï¼‰
- Gradle 8+ï¼ˆé¡¹ç›®è‡ªå¸¦ Wrapperï¼Œå¯ç›´æ¥è¿è¡Œ `./gradlew`ï¼‰
- å¯è®¿é—®å¤–ç½‘ï¼Œç”¨äºè¯·æ±‚ Doubao / DeepSeek API

### 4.2 åœ¨ IDEA ä¸­å¯åŠ¨åç«¯

**æ­¥éª¤ 1ï¼šåˆ›å»ºè¿è¡Œé…ç½®**

1. åœ¨ IDEA ä¸­æ‰“å¼€é¡¹ç›®
2. æ‰¾åˆ°ä¸»ç±»ï¼š`DreamAiChatBackendApplication.kt`
   - è·¯å¾„ï¼š`DreamAIChat_backend/src/main/kotlin/com/dreamaichat/backend/DreamAiChatBackendApplication.kt`
3. å³é”®ç‚¹å‡»ä¸»ç±»æ–‡ä»¶ï¼Œé€‰æ‹© **"Run 'DreamAiChatBackendApplication'"**
   - æˆ–è€…ç‚¹å‡»ä¸»ç±»æ–‡ä»¶å·¦ä¾§çš„ç»¿è‰²ä¸‰è§’å½¢ â–¶ï¸

**æ­¥éª¤ 2ï¼šé…ç½®è¿è¡Œå‚æ•°**

1. ç‚¹å‡» IDEA é¡¶éƒ¨å·¥å…·æ çš„ **"Run"** â†’ **"Edit Configurations..."**
2. åœ¨å·¦ä¾§æ‰¾åˆ° **"DreamAiChatBackendApplication"** é…ç½®
3. åœ¨å³ä¾§é…ç½®é¢æ¿ä¸­ï¼š

   **a. è®¾ç½® Active profilesï¼ˆé‡è¦ï¼ï¼‰**
   
   - æ‰¾åˆ° **"Active profiles"** å­—æ®µ
   - è¾“å…¥ï¼š`local`
   - æˆ–è€…åœ¨ **"VM options"** ä¸­æ·»åŠ ï¼š`-Dspring.profiles.active=local`
   
   **b. è®¾ç½®ç¯å¢ƒå˜é‡**
   
   - æ‰¾åˆ° **"Environment variables"**
   - æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼ˆå¦‚æœä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è·³è¿‡æ­¤æ­¥ï¼‰ï¼š
     ```
     DEEPSEEK_API_KEY=sk-ä½ çš„å¯†é’¥
     DOUBAO_API_KEY=ä½ çš„è±†åŒ…å¯†é’¥
     ```

4. ç‚¹å‡» **"Apply"** â†’ **"OK"** ä¿å­˜é…ç½®

**æ­¥éª¤ 3ï¼šå¯åŠ¨åç«¯**

1. ç‚¹å‡» IDEA é¡¶éƒ¨å·¥å…·æ çš„ç»¿è‰²è¿è¡ŒæŒ‰é’® â–¶ï¸
2. æˆ–è€…æŒ‰å¿«æ·é”®ï¼š`Shift + F10`
3. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   The following profiles are active: local
   Tomcat started on port 8081
   Started DreamAiChatBackendApplication in Xs
   ```

### 4.3 é…ç½® API Keyï¼ˆç³»ç»Ÿç¯å¢ƒå˜é‡æ–¹å¼ï¼‰

**æ­¥éª¤ 1ï¼šè®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡**

1. æŒ‰ `Win + R`ï¼Œè¾“å…¥ `sysdm.cpl`ï¼Œå›è½¦
2. ç‚¹å‡» **"é«˜çº§"** â†’ **"ç¯å¢ƒå˜é‡"**
3. åœ¨ **"ç”¨æˆ·å˜é‡"** åŒºåŸŸç‚¹å‡» **"æ–°å»º"**ï¼š
   - å˜é‡åï¼š`DEEPSEEK_API_KEY`
   - å˜é‡å€¼ï¼šä½ çš„ DeepSeek API Keyï¼ˆæ ¼å¼ï¼š`sk-xxxxx`ï¼‰
4. å†æ¬¡ç‚¹å‡» **"æ–°å»º"**ï¼š
   - å˜é‡åï¼š`DOUBAO_API_KEY`
   - å˜é‡å€¼ï¼šä½ çš„è±†åŒ… API Key
5. ç‚¹å‡» **"ç¡®å®š"** ä¿å­˜

**æ­¥éª¤ 2ï¼šåœ¨ IDEA è¿è¡Œé…ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡**

1. åœ¨ IDEA è¿è¡Œé…ç½®çš„ **"Environment variables"** ä¸­æ·»åŠ ï¼š
   ```
   DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
   DOUBAO_API_KEY=${DOUBAO_API_KEY}
   ```
2. æˆ–è€…ç›´æ¥å¡«å†™å®é™…å€¼ï¼ˆä¸æ¨èï¼Œå› ä¸ºä¼šä¿å­˜åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼‰

**æ­¥éª¤ 3ï¼šé‡å¯åç«¯æœåŠ¡**

1. åœæ­¢å½“å‰è¿è¡Œçš„åç«¯ï¼ˆå¦‚æœæ­£åœ¨è¿è¡Œï¼‰
2. åœ¨ IDEA ä¸­é‡æ–°å¯åŠ¨åç«¯
3. åç«¯ä¼šè‡ªåŠ¨ä»ç³»ç»Ÿç¯å¢ƒå˜é‡è¯»å– API Key

### 4.4 å¯ç”¨æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
| --- | --- | --- |
| `POST /api/auth/register` | åˆ›å»ºè´¦å·ï¼ˆaccount + passwordï¼‰ |
| `POST /api/auth/login` | ç™»å½•ï¼Œè¿”å› `token` ä¸ `userId` |
| `GET /api/chat/conversations` | è·å–å½“å‰ç”¨æˆ·çš„ä¼šè¯åˆ—è¡¨ï¼ˆéœ€è¦ `Authorization: Bearer <token>`ï¼‰ |
| `POST /api/chat/send` | å‘æ‰€é€‰æ¨¡å‹å‘é€æ¶ˆæ¯ï¼ŒåŒæ—¶å†™å…¥ä¼šè¯ä¸æ¶ˆæ¯è¡¨ |

æ‰€æœ‰æ¥å£éƒ½è¿”å›ç»Ÿä¸€çš„ `ApiResponse<T>`ï¼ŒAndroid ä¾§å·²ç»é€‚é…ã€‚

### 4.5 ä¸ Android è”è°ƒ

1. å¯åŠ¨åç«¯ï¼ˆé»˜è®¤ç«¯å£ 8081ï¼‰
2. ç¡®ä¿æ¨¡æ‹Ÿå™¨å¯è®¿é—®ä¸»æœºï¼ŒAndroid ç«¯ `RetrofitClient` å·²è®¾ç½® `http://10.0.2.2:8081/`
3. åœ¨ App å†…ç‚¹å‡»æ³¨å†Œæˆ–ç™»å½•ï¼ŒæˆåŠŸåä¼šå°† Token å†™å…¥ `SessionManager`
4. èŠå¤©/å†å²é¡µé¢å³å¯å®æ—¶è°ƒç”¨åç«¯

> ç”Ÿäº§éƒ¨ç½²æ—¶å¯å°† `DreamAIChat_backend` æ‰“åŒ…ä¸º Jarï¼š`./gradlew bootJar`ï¼Œä¸Šä¼ è‡³æœåŠ¡å™¨åè¿è¡Œ `java -jar build/libs/DreamAIChat_backend-0.1.0.jar`ï¼Œå¹¶é€šè¿‡ `application.yml` æˆ–ç¯å¢ƒå˜é‡è¦†ç›–ç«¯å£ã€æ•°æ®åº“ç­‰é…ç½®ã€‚

### 4.6 å¤§æ¨¡å‹ API Key ç”³è¯·ä¸é…ç½®

#### 4.6.1 ç”³è¯· API Key

**DeepSeek API Key**ï¼š
1. è®¿é—® https://platform.deepseek.com/
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. è¿›å…¥ **"API Keys"** é¡µé¢
4. ç‚¹å‡» **"Create API Key"**ï¼Œå¤åˆ¶ç”Ÿæˆçš„ Keyï¼ˆæ ¼å¼ï¼š`sk-xxxxx`ï¼‰

**è±†åŒ… API Key**ï¼š
1. è®¿é—® https://www.volcengine.com/
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. æœç´¢å¹¶å¼€é€š **"è±†åŒ…"** æœåŠ¡
4. åœ¨ **"API å¯†é’¥ç®¡ç†"** ä¸­åˆ›å»ºå¯†é’¥ï¼Œå¤åˆ¶ç”Ÿæˆçš„ Key

#### 4.6.2 é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡

1. æŒ‰ `Win + R`ï¼Œè¾“å…¥ `sysdm.cpl`ï¼Œå›è½¦
2. ç‚¹å‡» **"é«˜çº§"** â†’ **"ç¯å¢ƒå˜é‡"**
3. åœ¨ **"ç”¨æˆ·å˜é‡"** åŒºåŸŸç‚¹å‡» **"æ–°å»º"**ï¼š
   - å˜é‡åï¼š`DEEPSEEK_API_KEY`ï¼Œå˜é‡å€¼ï¼šä½ çš„ DeepSeek API Key
   - å˜é‡åï¼š`DOUBAO_API_KEY`ï¼Œå˜é‡å€¼ï¼šä½ çš„è±†åŒ… API Key
4. ç‚¹å‡» **"ç¡®å®š"** ä¿å­˜
5. **é‡è¦**ï¼šå…³é—­æ‰€æœ‰å·²æ‰“å¼€çš„ç»ˆç«¯/IDEA çª—å£ï¼Œé‡æ–°æ‰“å¼€ IDEA

#### 4.6.3 åœ¨ IDEA ä¸­é…ç½®ç¯å¢ƒå˜é‡

1. åœ¨ IDEA è¿è¡Œé…ç½®çš„ **"Environment variables"** ä¸­æ·»åŠ ï¼š
   ```
   DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
   DOUBAO_API_KEY=${DOUBAO_API_KEY}
   ```
2. æˆ–è€…ç›´æ¥å¡«å†™å®é™…å€¼ï¼ˆä¸æ¨èï¼‰

#### 4.6.4 éªŒè¯é…ç½®

1. åœ¨ IDEA ä¸­å¯åŠ¨åç«¯
2. åœ¨ Android åº”ç”¨ä¸­å‘é€æµ‹è¯•æ¶ˆæ¯
3. å¦‚æœæ”¶åˆ°çœŸå®çš„ AI å›å¤ï¼ˆä¸æ˜¯æ¼”ç¤ºæ¨¡å¼ï¼‰ï¼Œè¯´æ˜é…ç½®æˆåŠŸ âœ…

**æ³¨æ„**ï¼š
- æ¨¡å‹åç§°å¿…é¡»ä¸ç«å±±å¼•æ“æ§åˆ¶å°ä¸­çš„åç§°å®Œå…¨ä¸€è‡´ï¼ˆè±†åŒ…ï¼š`doubao-seed-1-6-vision-250815`ï¼‰
- å¦‚æœä¿®æ”¹æ¨¡å‹åç§°ï¼Œéœ€è¦ç¡®ä¿æ–°æ¨¡å‹åœ¨ä½ çš„è´¦æˆ·ä¸­å¯ç”¨
- è¯¦ç»†é—®é¢˜æ’æŸ¥è¯·å‚è€ƒ `vibe_codingå®è·µæ–‡æ¡£/æ•…éšœæ’æŸ¥åŠè§£å†³æ–‡æ¡£.md`



## 5 é…ç½®æ•°æ®åº“

### 5.1 ä»€ä¹ˆæ˜¯ Room æ•°æ®åº“ï¼Ÿ

**ç®€å•ç†è§£**ï¼š
- Room æ˜¯ Android å®˜æ–¹æä¾›çš„æ•°æ®åº“æ¡†æ¶ï¼ŒåŸºäº SQLite
- å°±åƒ Excel è¡¨æ ¼ä¸€æ ·ï¼Œç”¨æ¥å­˜å‚¨åº”ç”¨çš„æ•°æ®ï¼ˆç”¨æˆ·ä¿¡æ¯ã€èŠå¤©è®°å½•ç­‰ï¼‰
- æ•°æ®ä¼šä¿å­˜åœ¨æ‰‹æœºæœ¬åœ°ï¼Œå³ä½¿å…³é—­åº”ç”¨ä¹Ÿä¸ä¼šä¸¢å¤±

**æ•°æ®åº“ç»“æ„**ï¼š
- **users è¡¨**ï¼šå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼ˆè´¦å·ã€å¯†ç ã€ç”¨æˆ·åç­‰ï¼‰
- **conversations è¡¨**ï¼šå­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼ˆå¯¹è¯æ ‡é¢˜ã€ä½¿ç”¨çš„æ¨¡å‹ç­‰ï¼‰
- **messages è¡¨**ï¼šå­˜å‚¨æ¶ˆæ¯å†…å®¹ï¼ˆç”¨æˆ·æ¶ˆæ¯ã€AIå›å¤ç­‰ï¼‰

**æ•°æ®å…³ç³»**ï¼š
```
ç”¨æˆ· (users)
  â””â”€â”€ ä¼šè¯ (conversations) - ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªä¼šè¯
        â””â”€â”€ æ¶ˆæ¯ (messages) - ä¸€ä¸ªä¼šè¯å¯ä»¥æœ‰å¤šæ¡æ¶ˆæ¯
```

#### 5.1.1 Room ä¸ JDBC / Navicat çš„ç›´è§‚å¯¹æ¯”

| ç»´åº¦ | JDBC + Navicat | Room |
| --- | --- | --- |
| æ€ç»´æ¨¡å‹ | æ‰‹å†™ SQL â†’ ç”¨è¿æ¥ä¸²è¿åˆ° MySQL | ä»ç„¶æ˜¯ SQLiteï¼Œä½†ç”¨æ³¨è§£æè¿°è¡¨ç»“æ„ï¼ŒRoom è‡ªåŠ¨ç”Ÿæˆ SQL |
| è¿æ¥æ–¹å¼ | ç›´æ¥è¿æ¥è¿œç¨‹æ•°æ®åº“ï¼ŒNavicat å¯å®æ—¶æŸ¥çœ‹ | App å†…åµŒ SQLite æ–‡ä»¶ï¼Œè¿è¡Œåœ¨æ‰‹æœºæ²™ç®±ï¼›é€šè¿‡å·¥å…·â€œçª¥è§†â€ |
| å¸¸è§å¼€å‘ç—›ç‚¹ | éœ€è¦æ‰‹åŠ¨ç®¡ç†è¿æ¥ã€äº‹åŠ¡ã€æ¸¸æ ‡ | Room è‡ªåŠ¨å¤„ç†çº¿ç¨‹/äº‹åŠ¡ï¼Œå¯ç”¨ DAO æ¥å£å£°æ˜ CRUD |
| é€‚ç”¨åœºæ™¯ | æœåŠ¡ç«¯ã€PC å·¥å…· | Android å®¢æˆ·ç«¯ç¦»çº¿ç¼“å­˜ã€æœ¬åœ°æŒä¹…åŒ– |

å¯ä»¥æŠŠ Room æƒ³è±¡æˆâ€œå†…åµŒç‰ˆçš„ Navicat + ORMâ€ï¼š

1. **Entityï¼ˆè¡¨ç»“æ„ï¼‰** â‰ˆ Navicat ä¸­å»ºè¡¨
2. **DAOï¼ˆæ¥å£ï¼‰** â‰ˆ åœ¨ Navicat é‡Œè¿è¡Œçš„ SQL è¯­å¥
3. **Databaseï¼ˆAppDatabaseï¼‰** â‰ˆ Navicat çš„è¿æ¥é…ç½®

#### 5.1.2 Room çš„â€œä¸‰ä»¶å¥—â€åœ¨é¡¹ç›®ä¸­çš„å¯¹åº”æ–‡ä»¶

| è§’è‰² | èŒè´£ | å¯¹åº”æ–‡ä»¶ |
| --- | --- | --- |
| `@Entity` | æè¿°è¡¨å­—æ®µ | `data/entity/ConversationEntity.java`ã€`MessageEntity.java`ã€`UserEntity.java` |
| `@Dao` | å®šä¹‰ CRUD æ¥å£ | `data/dao/ConversationDao.java`ã€`MessageDao.java`ã€`UserDao.java` |
| `RoomDatabase` | æä¾›æ•°æ®åº“è®¿é—®å…¥å£ | `data/database/AppDatabase.java` |

è°ƒç”¨é¡ºåºï¼š

```
ChatViewModel â†’ MessageRepository â†’ MessageDao â†’ Room â†’ SQLite
```

æ‰€ä»¥ä½ åœ¨ UI å±‚åªéœ€è°ƒç”¨ Repositoryï¼ŒRoom ä¼šè´Ÿè´£æŠŠè¯·æ±‚ç¿»è¯‘æˆ SQL å¹¶æ›´æ–° SQLite æ–‡ä»¶ã€‚

#### 5.1.3 å’Œæœ¬é¡¹ç›®çš„ä¸šåŠ¡æ˜ å°„

- ç™»å½•åï¼Œ`SessionManager` ä¿å­˜ `userId`
- èŠå¤©æ—¶ï¼š
  1. `ChatViewModel` ç»„è£… `ConversationEntity` / `MessageEntity`
  2. é€šè¿‡ `ConversationRepository`ã€`MessageRepository` å†™å…¥ Room
  3. å†å²é¡µé¢ (`HistoryFragment`) é€šè¿‡ DAO æŸ¥è¯¢ `conversations`ï¼ŒRecyclerView å±•ç¤º

ç†è§£è¿™æ¡é“¾è·¯åï¼Œå†å»çœ‹ `ConversationRepository.insertOrUpdateConversation()` ä¸ `ChatViewModel.persistConversationAndMessages()` ä¼šæ›´åŠ ç›´è§‚ã€‚

### 5.2 æ•°æ®åº“æ–‡ä»¶ä½ç½®

**æ•°æ®åº“æ–‡ä»¶ä½ç½®**ï¼š
- åº”ç”¨é¦–æ¬¡è¿è¡Œåï¼Œæ•°æ®åº“æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»º
- ä½ç½®ï¼š`/data/data/com.example.dreamaichat_app/databases/dreamai_chat.db`
- è¿™æ˜¯åº”ç”¨ç§æœ‰ç›®å½•ï¼Œå…¶ä»–åº”ç”¨æ— æ³•è®¿é—®

**å¦‚ä½•æŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶**ï¼ˆå¼€å‘è°ƒè¯•ï¼‰ï¼š
1. ä½¿ç”¨ Android Studio çš„ Device File Explorer
   - ç‚¹å‡» `View` â†’ `Tool Windows` â†’ `Device File Explorer`
   - å¯¼èˆªåˆ° `/data/data/com.example.dreamaichat_app/databases/`
   - å¯ä»¥çœ‹åˆ° `dreamai_chat.db` æ–‡ä»¶

2. ä½¿ç”¨ ADB å‘½ä»¤ï¼ˆéœ€è¦ root æƒé™ï¼‰
   ```bash
   adb shell
   run-as com.example.dreamaichat_app
   cd databases
   ls
   ```

### 5.3 æ•°æ®åº“é…ç½®è¯´æ˜

**æ­¥éª¤ 1ï¼šæ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å·²åˆ›å»º**

æ•°æ®åº“æ–‡ä»¶åœ¨ä»¥ä¸‹ä½ç½®ï¼š
```
app/src/main/java/com/example/dreamaichat_app/data/database/AppDatabase.java
```

**æ­¥éª¤ 2ï¼šäº†è§£æ•°æ®åº“é…ç½®**

æ‰“å¼€ `AppDatabase.java`ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹é…ç½®ï¼š

```java
@Database(
    entities = {
        UserEntity.class,        // ç”¨æˆ·è¡¨
        ConversationEntity.class, // ä¼šè¯è¡¨
        MessageEntity.class      // æ¶ˆæ¯è¡¨
    },
    version = 1,  // æ•°æ®åº“ç‰ˆæœ¬å·
    exportSchema = false
)
```

**é‡è¦é…ç½®è¯´æ˜**ï¼š

1. **æ•°æ®åº“åç§°**ï¼š
   
   ```java
   private static final String DATABASE_NAME = "dreamai_chat.db";
   ```
   - è¿™æ˜¯æ•°æ®åº“æ–‡ä»¶å
   - å¯ä»¥ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„åç§°ï¼ˆå¦‚ `my_chat.db`ï¼‰
   - ä¿®æ”¹åï¼Œæ—§æ•°æ®åº“ä¼šè¢«åˆ é™¤ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   
2. **æ•°æ®åº“ç‰ˆæœ¬**ï¼š
   ```java
   version = 1
   ```
   - æ¯æ¬¡ä¿®æ”¹è¡¨ç»“æ„ï¼ˆæ·»åŠ å­—æ®µã€åˆ é™¤è¡¨ç­‰ï¼‰æ—¶ï¼Œéœ€è¦é€’å¢ç‰ˆæœ¬å·
   - ä¾‹å¦‚ï¼šç¬¬ä¸€æ¬¡ä¿®æ”¹åæ”¹ä¸º `version = 2`
   - ç”Ÿäº§ç¯å¢ƒéœ€è¦å®ç° `Migration` ç±»æ¥è¿ç§»æ•°æ®

3. **å¼€å‘ç¯å¢ƒé…ç½®**ï¼š
   ```java
   .fallbackToDestructiveMigration()  // ç‰ˆæœ¬å‡çº§æ—¶åˆ é™¤æ—§æ•°æ®
   .allowMainThreadQueries()          // å…è®¸åœ¨ä¸»çº¿ç¨‹æŸ¥è¯¢
   ```
   - **æ³¨æ„**ï¼šè¿™äº›é…ç½®ä»…ç”¨äºå¼€å‘ç¯å¢ƒ
   - ç”Ÿäº§ç¯å¢ƒéœ€è¦ç§»é™¤ `allowMainThreadQueries()`ï¼Œå¹¶ä½¿ç”¨åå°çº¿ç¨‹

### 5.4 æ•°æ®åº“åˆå§‹åŒ–æµç¨‹

**é¦–æ¬¡è¿è¡Œåº”ç”¨æ—¶**ï¼š

1. **åº”ç”¨å¯åŠ¨** â†’ è°ƒç”¨ `AppDatabase.getInstance(context)`
2. **Room æ¡†æ¶æ£€æŸ¥** â†’ æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿ
   - å¦‚æœä¸å­˜åœ¨ â†’ åˆ›å»ºæ•°æ®åº“æ–‡ä»¶
   - å¦‚æœå­˜åœ¨ â†’ æ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦åŒ¹é…
3. **åˆ›å»ºè¡¨ç»“æ„** â†’ æ ¹æ® `@Entity` æ³¨è§£è‡ªåŠ¨åˆ›å»ºè¡¨
4. **æ•°æ®åº“å°±ç»ª** â†’ å¯ä»¥å¼€å§‹ä½¿ç”¨

**æ•°æ®åº“è¡¨ç»“æ„**ï¼š

**users è¡¨**ï¼š
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | Long | ç”¨æˆ·IDï¼ˆä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰|
| account | String | ç”¨æˆ·è´¦å·ï¼ˆæ‰‹æœºå·æˆ–é‚®ç®±ï¼‰|
| password | String | å¯†ç ï¼ˆåŠ å¯†åï¼‰|
| username | String | ç”¨æˆ·å |
| avatarUrl | String | å¤´åƒURL |
| memberType | String | ä¼šå‘˜ç±»å‹ï¼ˆfree/premiumï¼‰|
| token | String | ç™»å½•Token |
| tokenExpireTime | Long | Tokenè¿‡æœŸæ—¶é—´ |
| createdAt | Long | åˆ›å»ºæ—¶é—´ |
| updatedAt | Long | æ›´æ–°æ—¶é—´ |

**conversations è¡¨**ï¼š
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | Long | ä¼šè¯IDï¼ˆä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰|
| userId | Long | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰|
| title | String | ä¼šè¯æ ‡é¢˜ |
| model | String | ä½¿ç”¨çš„AIæ¨¡å‹ |
| messageCount | Integer | æ¶ˆæ¯æ€»æ•° |
| isFavorite | Boolean | æ˜¯å¦æ”¶è— |
| lastMessagePreview | String | æœ€åæ¶ˆæ¯é¢„è§ˆ |
| lastMessageTime | Long | æœ€åæ¶ˆæ¯æ—¶é—´ |
| createdAt | Long | åˆ›å»ºæ—¶é—´ |
| updatedAt | Long | æ›´æ–°æ—¶é—´ |

**messages è¡¨**ï¼š
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | Long | æ¶ˆæ¯IDï¼ˆä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰|
| conversationId | Long | ä¼šè¯IDï¼ˆå¤–é”®ï¼‰|
| role | String | æ¶ˆæ¯ç±»å‹ï¼ˆuser/assistant/systemï¼‰|
| content | String | æ¶ˆæ¯å†…å®¹ |
| status | String | æ¶ˆæ¯çŠ¶æ€ï¼ˆsending/success/failedï¼‰|
| errorMessage | String | é”™è¯¯ä¿¡æ¯ |
| createdAt | Long | åˆ›å»ºæ—¶é—´ |
| updatedAt | Long | æ›´æ–°æ—¶é—´ |

### 5.5 å¦‚ä½•ä½¿ç”¨æ•°æ®åº“

**åœ¨ä»£ç ä¸­ä½¿ç”¨æ•°æ®åº“**ï¼š

1. **è·å– Repository å®ä¾‹**ï¼š
   ```java
   UserRepository userRepository = new UserRepository(context);
   ```

2. **æ’å…¥æ•°æ®**ï¼š
   ```java
   UserEntity user = new UserEntity("user@example.com", "password", "ç”¨æˆ·å");
   userRepository.insertOrUpdateUser(user)
       .subscribe(
           () -> Log.d("Database", "ç”¨æˆ·ä¿å­˜æˆåŠŸ"),
           error -> Log.e("Database", "ä¿å­˜å¤±è´¥", error)
       );
   ```

3. **æŸ¥è¯¢æ•°æ®**ï¼š
   ```java
   userRepository.getUserByAccount("user@example.com")
       .subscribe(
           user -> Log.d("Database", "æ‰¾åˆ°ç”¨æˆ·: " + user.username),
           error -> Log.e("Database", "æŸ¥è¯¢å¤±è´¥", error)
       );
   ```

### 5.6 æ•°æ®åº“è¿ç§»ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

**ä»€ä¹ˆæ—¶å€™éœ€è¦è¿ç§»**ï¼š

- ä¿®æ”¹äº†è¡¨ç»“æ„ï¼ˆæ·»åŠ å­—æ®µã€åˆ é™¤å­—æ®µã€ä¿®æ”¹å­—æ®µç±»å‹ï¼‰
- éœ€è¦ä¿ç•™æ—§æ•°æ®

**è¿ç§»æ­¥éª¤**ï¼š

1. **å¢åŠ æ•°æ®åº“ç‰ˆæœ¬å·**ï¼š
   ```java
   @Database(..., version = 2)  // ä» 1 æ”¹ä¸º 2
   ```

2. **åˆ›å»º Migration ç±»**ï¼š
   ```java
   static final Migration MIGRATION_1_2 = new Migration(1, 2) {
       @Override
       public void migrate(SupportSQLiteDatabase database) {
           // æ·»åŠ æ–°å­—æ®µ
           database.execSQL("ALTER TABLE users ADD COLUMN nickname TEXT");
       }
   };
   ```

3. **åº”ç”¨ Migration**ï¼š
   ```java
   .addMigrations(MIGRATION_1_2)
   ```

### 5.7 éªŒè¯æ•°æ®åº“æ˜¯å¦æ­£å¸¸å·¥ä½œ

**æ–¹æ³• 1ï¼šæŸ¥çœ‹æ—¥å¿—**

è¿è¡Œåº”ç”¨åï¼Œåœ¨ Logcat ä¸­æœç´¢ "Database" æˆ– "Room"ï¼š
- å¦‚æœçœ‹åˆ° "æ•°æ®åº“åˆ›å»ºæˆåŠŸ" æˆ–ç±»ä¼¼æ—¥å¿—ï¼Œè¯´æ˜æ•°æ®åº“æ­£å¸¸
- å¦‚æœçœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼Œæ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®

**æ–¹æ³• 2ï¼šæµ‹è¯•æ•°æ®æ“ä½œ**

åœ¨ä»£ç ä¸­æ·»åŠ æµ‹è¯•ä»£ç ï¼š
```java
// æµ‹è¯•æ’å…¥ç”¨æˆ·
UserRepository repository = new UserRepository(context);
UserEntity testUser = new UserEntity("test@example.com", "123456", "æµ‹è¯•ç”¨æˆ·");
repository.insertOrUpdateUser(testUser)
    .subscribe(
        () -> Log.d("Test", "âœ… æ•°æ®åº“æµ‹è¯•æˆåŠŸ"),
        error -> Log.e("Test", "âŒ æ•°æ®åº“æµ‹è¯•å¤±è´¥", error)
    );
```

**æ–¹æ³• 3ï¼šä½¿ç”¨æ•°æ®åº“æŸ¥çœ‹å·¥å…·**

1. å¯¼å‡ºæ•°æ®åº“æ–‡ä»¶åˆ°ç”µè„‘
2. ä½¿ç”¨ SQLite æŸ¥çœ‹å·¥å…·ï¼ˆå¦‚ DB Browser for SQLiteï¼‰æ‰“å¼€
3. æŸ¥çœ‹è¡¨ç»“æ„å’Œæ•°æ®

### 5.8 å¸¸è§é—®é¢˜

**é—®é¢˜ 1ï¼šæ•°æ®åº“æ–‡ä»¶æœªåˆ›å»º**

**åŸå› **ï¼š
- åº”ç”¨æœªè¿è¡Œ
- æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®ä¿åº”ç”¨å·²è¿è¡Œè‡³å°‘ä¸€æ¬¡
2. æ£€æŸ¥ `AppDatabase.java` ä¸­çš„é…ç½®æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ Logcat ä¸­çš„é”™è¯¯ä¿¡æ¯

**é—®é¢˜ 2ï¼šRoom ç¼–è¯‘é”™è¯¯**

**åŸå› **ï¼š
- ç¼ºå°‘ `kapt` æ’ä»¶
- `room-compiler` ä¾èµ–æœªæ­£ç¡®é…ç½®

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `app/build.gradle.kts` ä¸­æ˜¯å¦åŒ…å«ï¼š
   ```kotlin
   plugins {
       alias(libs.plugins.kotlin.kapt)
   }
   dependencies {
       kapt(libs.room.compiler)
   }
   ```
2. åŒæ­¥ Gradleï¼š`File` â†’ `Sync Project with Gradle Files`
3. æ¸…ç†é¡¹ç›®ï¼š`Build` â†’ `Clean Project`

**é—®é¢˜ 3ï¼šæ•°æ®ä¸¢å¤±**

**åŸå› **ï¼š
- ä½¿ç”¨äº† `fallbackToDestructiveMigration()`
- æ•°æ®åº“ç‰ˆæœ¬å·æ”¹å˜

**è§£å†³æ–¹æ³•**ï¼š
- å¼€å‘ç¯å¢ƒï¼šè¿™æ˜¯æ­£å¸¸è¡Œä¸ºï¼Œæ•°æ®ä¼šè¢«æ¸…ç©º
- ç”Ÿäº§ç¯å¢ƒï¼šå®ç° `Migration` ç±»æ¥ä¿ç•™æ•°æ®

**é—®é¢˜ 4ï¼šæŸ¥è¯¢è¿”å›ç©ºæ•°æ®**

**åŸå› **ï¼š
- æ•°æ®æœªæ’å…¥
- æŸ¥è¯¢æ¡ä»¶é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥æ•°æ®æ˜¯å¦å·²æ’å…¥ï¼ˆä½¿ç”¨æ•°æ®åº“æŸ¥çœ‹å·¥å…·ï¼‰
2. æ£€æŸ¥æŸ¥è¯¢æ¡ä»¶æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ Logcat ä¸­çš„æŸ¥è¯¢æ—¥å¿—

### 5.9 æ•°æ®å¯è§†åŒ– & è°ƒè¯•å·¥å…·ï¼ˆNavicat æ€è·¯å¹³ç§»ï¼‰

å³ä¾¿æ•°æ®åº“åœ¨æ‰‹æœºæ²™ç®±é‡Œï¼Œä»ç„¶å¯ä»¥åƒ Navicat ä¸€æ ·â€œçœ‹è¡¨ã€è·‘ SQLâ€ï¼š

1. **Android Studio Database Inspectorï¼ˆå®æ—¶æŸ¥çœ‹ï¼‰**
   - è¿è¡Œ App â†’ `View` â†’ `Tool Windows` â†’ `App Inspection`
   - é€‰æ‹©æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ â†’ å±•å¼€ `Databases` â†’ `dreamai_chat.db`
   - å¯ä»¥ç›´æ¥æµè§ˆè¡¨ã€åŒå‡»è¡Œã€ç”šè‡³æ‰§è¡Œ `SELECT * FROM messages ORDER BY createdAt DESC`
   - æ”¯æŒçƒ­æ›´æ–°ï¼šå½“ä½ åœ¨ App å†…å‘é€ä¸€æ¡æ¶ˆæ¯ï¼ŒInspector ä¼šç«‹åˆ»åˆ·æ–°

2. **å¯¼å‡º SQLite æ–‡ä»¶åç”¨æ¡Œé¢å·¥å…·æŸ¥çœ‹**
   - `adb shell run-as com.example.dreamaichat_app cp /data/data/com.example.dreamaichat_app/databases/dreamai_chat.db /sdcard/Download/dreamai_chat.db`
   - `adb pull /sdcard/Download/dreamai_chat.db .`
   - ä½¿ç”¨ DB Browser for SQLite / SQLiteStudio / TablePlus æ‰“å¼€ï¼Œå°±åƒç”¨ Navicat æŸ¥çœ‹ MySQL

3. **ç¬¬ä¸‰æ–¹æ’ä»¶**
   - Android Studio Marketplace ä¸­æœç´¢ â€œSampleSQLiteBrowserâ€ï¼Œå¯ä»¥è·å¾—æ›´æ¥è¿‘ Navicat çš„ç•Œé¢

> å°è´´å£«ï¼šRoom ä¹Ÿå¯ä»¥å¼€å¯ `setJournalMode(TRUNCATE)`ã€`setQueryCallback` æ¥æŠŠ SQL æ‰“å°åˆ° Logcatï¼Œæ–¹ä¾¿å¯¹ç…§ JDBC æ—¶ä»£çš„ SQLã€‚

### 5.9 æ•°æ®åº“æœ€ä½³å®è·µ

1. **ä½¿ç”¨åå°çº¿ç¨‹**ï¼š
   - ç”Ÿäº§ç¯å¢ƒå¿…é¡»åœ¨åå°çº¿ç¨‹æ‰§è¡Œæ•°æ®åº“æ“ä½œ
   - ä½¿ç”¨ RxJava çš„ `subscribeOn(Schedulers.io())`

2. **åŠæ—¶å…³é—­è¿æ¥**ï¼š
   - åº”ç”¨é€€å‡ºæ—¶è°ƒç”¨ `AppDatabase.closeDatabase()`
   - é¿å…å†…å­˜æ³„æ¼

3. **æ•°æ®å¤‡ä»½**ï¼š
   - å®šæœŸå¤‡ä»½é‡è¦æ•°æ®
   - ä½¿ç”¨ Room çš„å¯¼å‡ºåŠŸèƒ½

4. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨ç´¢å¼•åŠ é€ŸæŸ¥è¯¢ï¼ˆå·²åœ¨ Entity ä¸­å®šä¹‰ï¼‰
   - é¿å…åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ
   - ä½¿ç”¨æ‰¹é‡æ’å…¥æé«˜æ•ˆç‡



### 5.10 ä¸‹ä¸€æ­¥

é…ç½®å®Œæ•°æ®åº“åï¼š
1. âœ… è¿è¡Œåº”ç”¨ï¼Œç¡®è®¤æ•°æ®åº“æ–‡ä»¶å·²åˆ›å»º
2. âœ… æµ‹è¯•æ•°æ®æ’å…¥å’ŒæŸ¥è¯¢åŠŸèƒ½
3. âœ… æŸ¥çœ‹ Logcat ç¡®è®¤æ²¡æœ‰é”™è¯¯
4. âœ… ç»§ç»­å¼€å‘å…¶ä»–åŠŸèƒ½



## 6. æ„å»ºé¡¹ç›®

### 6.1 ä½¿ç”¨ Android Studio

1. **é€‰æ‹©æ„å»ºå˜ä½“**
   - ç‚¹å‡» `Build` â†’ `Select Build Variant`
   - é€‰æ‹© `debug` æˆ– `release`

2. **æ„å»º APK**
   - ç‚¹å‡» `Build` â†’ `Build Bundle(s) / APK(s)` â†’ `Build APK(s)`
   - æ„å»ºå®Œæˆåï¼ŒAPK ä½äº `app/build/outputs/apk/`

3. **è¿è¡Œåº”ç”¨**
   - è¿æ¥ Android è®¾å¤‡æˆ–å¯åŠ¨æ¨¡æ‹Ÿå™¨
   - ç‚¹å‡» `Run` â†’ `Run 'app'` æˆ–æŒ‰ `Shift + F10`

### 6.2 ä½¿ç”¨å‘½ä»¤è¡Œ

#### Windows

```powershell
# æ¸…ç†æ„å»º
.\gradlew clean

# æ„å»º Debug APK
.\gradlew assembleDebug

# æ„å»º Release APK
.\gradlew assembleRelease

# å®‰è£…åˆ°è®¾å¤‡
.\gradlew installDebug
```

#### macOS/Linux

```bash
# æ¸…ç†æ„å»º
./gradlew clean

# æ„å»º Debug APK
./gradlew assembleDebug

# æ„å»º Release APK
./gradlew assembleRelease

# å®‰è£…åˆ°è®¾å¤‡
./gradlew installDebug
```



## 7. è¿è¡Œåº”ç”¨

### 7.1 åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ

1. **åˆ›å»ºæ¨¡æ‹Ÿå™¨**
   - æ‰“å¼€ `Tools` â†’ `Device Manager`
   - ç‚¹å‡» `Create Device`
   - é€‰æ‹©è®¾å¤‡å‹å·å’Œç³»ç»Ÿé•œåƒï¼ˆAPI 21+ï¼‰
   - å®Œæˆåˆ›å»º

2. **è¿è¡Œåº”ç”¨**
   - é€‰æ‹©åˆ›å»ºçš„æ¨¡æ‹Ÿå™¨
   - ç‚¹å‡» `Run` æŒ‰é’®

### 7.2 åœ¨çœŸæœºä¸Šè¿è¡Œ

1. **å¯ç”¨å¼€å‘è€…é€‰é¡¹**
   - æ‰“å¼€è®¾å¤‡ `è®¾ç½®` â†’ `å…³äºæ‰‹æœº`
   - è¿ç»­ç‚¹å‡» `ç‰ˆæœ¬å·` 7æ¬¡
   - è¿”å›è®¾ç½®ï¼Œæ‰¾åˆ° `å¼€å‘è€…é€‰é¡¹`

2. **å¯ç”¨ USB è°ƒè¯•**
   - åœ¨ `å¼€å‘è€…é€‰é¡¹` ä¸­å¯ç”¨ `USB è°ƒè¯•`
   - è¿æ¥è®¾å¤‡åˆ°ç”µè„‘

3. **è¿è¡Œåº”ç”¨**
   - Android Studio ä¼šè‡ªåŠ¨æ£€æµ‹è®¾å¤‡
   - é€‰æ‹©è®¾å¤‡å¹¶ç‚¹å‡» `Run`



## 8. å¸¸è§é—®é¢˜

### 8.1 Gradle åŒæ­¥å¤±è´¥

**é—®é¢˜**: Gradle åŒæ­¥æ—¶å‡ºç°é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥ `gradle/libs.versions.toml` ä¸­çš„ç‰ˆæœ¬å·æ˜¯å¦æ­£ç¡®
3. æ¸…ç†é¡¹ç›®: `File` â†’ `Invalidate Caches / Restart`
4. åˆ é™¤ `.gradle` æ–‡ä»¶å¤¹åé‡æ–°åŒæ­¥

### 8.2 ä¾èµ–ä¸‹è½½å¤±è´¥

**é—®é¢˜**: ä¾èµ–ä¸‹è½½è¶…æ—¶æˆ–å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. é…ç½®å›½å†…é•œåƒæºï¼ˆå¦‚é˜¿é‡Œäº‘ï¼‰
2. åœ¨ `build.gradle.kts` ä¸­æ·»åŠ é•œåƒé…ç½®:
   ```kotlin
   repositories {
       maven { url = uri("https://maven.aliyun.com/repository/public") }
       google()
       mavenCentral()
   }
   ```

### 8.3 Room ç¼–è¯‘é”™è¯¯

**é—®é¢˜**: Room æ³¨è§£å¤„ç†å™¨æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿å·²æ·»åŠ  `kotlin-kapt` æ’ä»¶
2. ç¡®ä¿ `room-compiler` ä¾èµ–å·²æ­£ç¡®é…ç½®
3. æ¸…ç†å¹¶é‡æ–°æ„å»ºé¡¹ç›®

### 8.4 ViewBinding ä¸å·¥ä½œ

**é—®é¢˜**: ViewBinding ç”Ÿæˆçš„ç±»æ‰¾ä¸åˆ°

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ `buildFeatures { viewBinding = true }` å·²é…ç½®
2. æ¸…ç†å¹¶é‡æ–°æ„å»ºé¡¹ç›®
3. æ£€æŸ¥å¸ƒå±€æ–‡ä»¶åç§°æ˜¯å¦æ­£ç¡®ï¼ˆä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰

### 8.5 ç½‘ç»œè¯·æ±‚å¤±è´¥

**é—®é¢˜**: API è¯·æ±‚è¿”å›é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `RetrofitClient` ä¸­çš„ `BASE_URL` æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ç½‘ç»œæƒé™æ˜¯å¦å·²æ·»åŠ ï¼ˆAndroidManifest.xmlï¼‰
3. æ£€æŸ¥ API æœåŠ¡å™¨æ˜¯å¦å¯è®¿é—®
4. æŸ¥çœ‹ Logcat ä¸­çš„é”™è¯¯ä¿¡æ¯



## 9. å›¾ç‰‡èµ„æºé…ç½®

> æœ¬ç« æŒ‰â€œå°ç™½æ¨¡å¼â€å†™ï¼šåªå‡è®¾ä½ æ‰‹é‡Œæœ‰ä¸€å † PNG å›¾ç‰‡ï¼Œæ²¡æœ‰ SVGã€ä¸ä¼šå†™ XMLï¼Œä¹Ÿä¸äº†è§£å„ç§ density çš„æ¦‚å¿µã€‚åªè¦è·Ÿç€æ­¥éª¤åšï¼Œå°±èƒ½æŠŠ APP é‡Œçš„å›¾æ ‡å…¨éƒ¨æ¢æˆä½ è‡ªå·±çš„ã€‚

### 9.1 å¯åŠ¨ / æ¡Œé¢å›¾æ ‡ï¼ˆåªç”¨ PNG çš„å®Œæ•´æ­¥éª¤ï¼‰

#### 9.1.1 å‡†å¤‡ä¸€å¼ â€œå¤§å›¾æ ‡â€PNG

1. å‡†å¤‡ä¸€å¼  **æ–¹å½¢** çš„ PNG å›¾ç‰‡ï¼Œä¾‹å¦‚ 1024Ã—1024ï¼ŒèƒŒæ™¯æœ€å¥½æ˜¯é€æ˜ã€‚
2. æŠŠå®ƒæ”¾åˆ°ç”µè„‘æŸä¸ªä½ èƒ½æ‰¾åˆ°çš„ä½ç½®ï¼Œæ¯”å¦‚ï¼š`D:\my_icons\app_logo.png`ã€‚

#### 9.1.2 ç”¨ Image Asset ä¸€æ¬¡æ€§ç”Ÿæˆæ‰€æœ‰ mipmap å’Œ XML

1. æ‰“å¼€ Android Studioï¼Œåœ¨å·¦ä¾§ `Project` è§†å›¾ä¸­æ‰¾åˆ° `app/src/main/res`ã€‚
2. åœ¨ `res` ä¸Š **å³é”®** â†’ `New` â†’ `Image Asset`ã€‚  
3. åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼š
   - `Icon Type` é€‰æ‹©ï¼š**Launcher Icons (Adaptive and Legacy)**ã€‚
   - `Name` å»ºè®®ä¿æŒä¸ºï¼š`ic_launcher`ï¼ˆé»˜è®¤ï¼‰ï¼Œä¸è¦æ”¹åï¼Œè¿™æ ·ä¸ç”¨åŠ¨å…¶ä»–é…ç½®ã€‚
4. åœ¨ `Foreground Layer` é‡Œï¼š
   - `Asset type` é€‰ **Image**ã€‚
   - ç‚¹å‡»å³è¾¹çš„æ–‡ä»¶å¤¹æŒ‰é’®ï¼Œé€‰æ‹©ä½ åˆšæ‰å‡†å¤‡çš„ PNGï¼ˆä¾‹å¦‚ `app_logo.png`ï¼‰ã€‚
   - é¢„è§ˆåŒºä¼šæ˜¾ç¤ºä¸€ä¸ªåœ†å½¢/æ–¹å½¢å›¾æ ‡ï¼Œå¦‚æœå›¾å¤ªå¤§/å¤ªå°ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æ»‘å—è°ƒæ•´ç¼©æ”¾ã€‚
5. å¦‚æœä¸æƒ³è¦å¤æ‚èƒŒæ™¯ï¼š
   - åœ¨ `Background Layer` ä¸­ï¼ŒæŠŠ `Color` æ”¹æˆä½ æƒ³è¦çš„çº¯è‰²èƒŒæ™¯ï¼ˆæ¯”å¦‚ç™½è‰²æˆ–å“ç‰Œè‰²ï¼‰ã€‚
6. ä¸€è·¯ç‚¹å‡» `Next` â†’ `Finish`ã€‚

å®Œæˆåï¼ŒAndroid Studio ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆå’Œè¦†ç›–ï¼š

- `mipmap-mdpi/ic_launcher.png`
- `mipmap-hdpi/ic_launcher.png`
- `mipmap-xhdpi/ic_launcher.png`
- `mipmap-xxhdpi/ic_launcher.png`
- `mipmap-xxxhdpi/ic_launcher.png`
- `mipmap-anydpi-v26/ic_launcher.xml`
- ä»¥åŠ `ic_launcher_round` ç³»åˆ—å’Œå¯¹åº”çš„ XMLã€‚

> **é‡è¦**ï¼šè¿™æ ·åšä¹‹åï¼Œæˆ‘ä»¬**ä¸éœ€è¦è‡ªå·±æ”¹ XML**ï¼›é‚£äº› XMLï¼ˆåŒ…æ‹¬ä½ çœ‹åˆ°çš„ `ic_launcher.xml`ï¼‰å·²ç»è‡ªåŠ¨æŒ‡å‘äº†ä½ è¿™å¼  PNGï¼ŒAndroid ä¼šè‡ªåŠ¨å¤„ç†å„ç§åˆ†è¾¨ç‡å’Œå½¢çŠ¶ã€‚

#### 9.1.3 åªæƒ³æ‰‹åŠ¨è¦†ç›– PNGï¼Œä¸æƒ³ç”¨ Image Assetï¼Ÿ

ä¸æ¨èï¼Œä½†å¦‚æœä½ å·²ç»æ‰‹åŠ¨æŠŠ `mipmap-*` é‡Œçš„ PNG éƒ½æ¢äº†ï¼Œåªå‰© XML ä¸ä¼šæ”¹ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼š

- `mipmap-anydpi-v26/ic_launcher.xml` æ˜¯ä¸€ä¸ªâ€œé…ç½®æ–‡ä»¶â€ï¼Œé‡Œé¢åªæ˜¯å‘Šè¯‰ç³»ç»Ÿâ€œå‰æ™¯å›¾ç”¨å“ªä¸ªå›¾ç‰‡ã€èƒŒæ™¯ç”¨å“ªä¸ªå›¾ç‰‡â€ã€‚
- æœ€ç®€å•çš„æ–¹å¼ä»ç„¶æ˜¯ç”¨ **9.1.2 çš„ Image Asset** å†è·‘ä¸€éï¼Œè¿™æ ·ä¼šè‡ªåŠ¨é‡å†™ XMLï¼Œé¿å…æ‰‹å·¥ä¿®æ”¹å‡ºé”™ã€‚

å¦‚æœä½ åšæŒæ‰‹åŠ¨ï¼Œä¸æƒ³é‡æ–°è·‘ Image Assetï¼Œå¯ä»¥è®°ä½ä¸€å¥è¯ï¼š  
**â€œä¸è¦éšä¾¿åˆ æˆ–æ”¹ ic_launcher.xml çš„ç»“æ„ï¼Œå®å¯ç”¨ Image Asset é‡å»ºã€‚â€**  
è¿™æ ·æœ€å®‰å…¨ã€ä¹Ÿæœ€çœå¿ƒã€‚

### 9.2 èŠå¤©ç•Œé¢ & å¯¼èˆªå›¾æ ‡å¯¹ç…§è¡¨ï¼ˆéƒ½å¯ä»¥æ¢æˆ PNGï¼‰

| èµ„æº | ç›®å½• | ä½¿ç”¨åœºæ™¯ | å¼•ç”¨æ–‡ä»¶ | æ›¿æ¢å»ºè®® |
| --- | --- | --- | --- | --- |
| `ic_attach` | `drawable/` | è¾“å…¥æ¡†"å›¾ç‰‡"æŒ‰é’®ï¼ˆæ— èƒŒæ™¯å›¾æ ‡æŒ‰é’®ï¼‰ | `fragment_chat.xml` | 32dp é™„ä»¶å›¾æ ‡ï¼Œå»ºè®®ä½¿ç”¨å•è‰²æˆ–é€æ˜èƒŒæ™¯ PNG |
| `ic_send` | `drawable/` | è¾“å…¥æ¡†"å‘é€"æŒ‰é’®ï¼ˆæ— èƒŒæ™¯å›¾æ ‡æŒ‰é’®ï¼‰ | `fragment_chat.xml` | 32dp å‘é€å›¾æ ‡ï¼Œå»ºè®®ä½¿ç”¨ç®­å¤´æˆ–å‘é€ç¬¦å· PNG |
| `ic_user_avatar` | `drawable/` | "æˆ‘çš„"é¡µé¢ç”¨æˆ·å¤´åƒ | `fragment_profile.xml` | 80Ã—80dp ç”¨æˆ·å¤´åƒï¼Œå»ºè®®ä½¿ç”¨åœ†å½¢å¤´åƒ PNG |
| `ic_template_code` | `drawable/` | å¯¹è¯æ¨¡æ¿"ç¼–ç¨‹åŠ©æ‰‹"å›¾æ ‡ | `item_template_simple.xml` | 40Ã—40dp ç¼–ç¨‹ç›¸å…³å›¾æ ‡ PNG |
| `ic_template_paper` | `drawable/` | å¯¹è¯æ¨¡æ¿"è®ºæ–‡åŠ©æ‰‹"å›¾æ ‡ | `item_template_simple.xml` | 40Ã—40dp æ–‡æ¡£/è®ºæ–‡ç›¸å…³å›¾æ ‡ PNG |
| `ic_template_medical` | `drawable/` | å¯¹è¯æ¨¡æ¿"åŒ»ç–—å’¨è¯¢"å›¾æ ‡ | `item_template_simple.xml` | 40Ã—40dp åŒ»ç–—/å¥åº·ç›¸å…³å›¾æ ‡ PNG |
| `ic_template_translate` | `drawable/` | å¯¹è¯æ¨¡æ¿"ç¿»è¯‘ä¸“å®¶"å›¾æ ‡ | `item_template_simple.xml` | 40Ã—40dp ç¿»è¯‘/è¯­è¨€ç›¸å…³å›¾æ ‡ PNG |
| `ic_copy_16` | `drawable/` | AI æ°”æ³¡å¤åˆ¶æŒ‰é’® | `item_message_ai.xml` | 16â€“20dpï¼Œé¿å…é®æŒ¡æ–‡æœ¬ |
| `ic_chevron_down` | `drawable/` | æ¨¡å‹åˆ‡æ¢ç®­å¤´ | `fragment_chat.xml`ï¼ˆæ¨¡å‹ headerï¼‰ | ä»…æ”¹è‰²å¯åœ¨ XML é‡Œè°ƒ `fillColor` |
| `ic_ai_avatar_placeholder` | `drawable/` | AI å¤´åƒå ä½ | `item_message_ai.xml` | å¯æ›¿æ¢ä¸ºå“ç‰Œè§’è‰²å¤´åƒ |
| `ic_pin_indicator` | `drawable/` | å†å²ç½®é¡¶æç¤º | `item_conversation.xml` | 16dp ä»¥å†…çš„å°é’‰å­å›¾æ ‡ |
| `ic_close_24` | `drawable/` | é™„ä»¶ç¼©ç•¥å›¾åˆ é™¤ | `item_attachment_preview.xml` | å»ºè®®ç”¨ç®€å•å‰å·/åƒåœ¾æ¡¶å›¾ |
| `ic_menu_24` | `drawable/` | Toolbar å·¦ä¸Šè§’æŠ½å±‰å›¾æ ‡ | `activity_main.xml` | å¯æ”¹ä¸ºå“ç‰Œ LOGO |
| `bg_model_tag` | `drawable/` (Shape) | æ¨¡å‹æ ‡ç­¾èƒŒæ™¯ | `fragment_chat.xml`ã€`item_conversation.xml` | æ”¹é¢œè‰²/åœ†è§’å³å¯ |
| `bg_system_message` | `drawable/` (Shape) | â€œæ­£åœ¨ç”Ÿæˆâ€æç¤º & é™„ä»¶å¡ç‰‡ | `fragment_chat.xml` | æ”¹æˆä½ å–œæ¬¢çš„æ°”æ³¡æ ·å¼ |
| `divider_attachment_preview` | `drawable/` (Shape) | é™„ä»¶åˆ†éš”çº¿ | `fragment_chat.xml` | æƒ³å»æ‰åˆ†éš”çº¿å°±è®¾ä¸ºé€æ˜ |
| `ic_tab_chat` | `drawable/` | åº•éƒ¨ TabBarâ€œèŠå¤©â€å›¾æ ‡ | `bottom_navigation.xml` | å»ºè®®ç”¨èŠå¤©æ°”æ³¡ç›¸å…³ PNG |
| `ic_tab_history` | `drawable/` | åº•éƒ¨ TabBarâ€œå†å²â€å›¾æ ‡ | `bottom_navigation.xml` | ç”¨æ—¶é’Ÿ/åˆ—è¡¨ç±»å›¾æ ‡ |
| `ic_tab_profile` | `drawable/` | åº•éƒ¨ TabBarâ€œæˆ‘çš„â€å›¾æ ‡ | `bottom_navigation.xml` | ç”¨å¤´åƒ/ç”¨æˆ·è½®å»“å›¾æ ‡ |
| `ic_toolbar_new_chat` | `drawable/` | é¡¶éƒ¨â€œæ–°å¯¹è¯â€æŒ‰é’® | `toolbar_menu.xml` | å¯ç”¨â€œ+â€æˆ–â€œæ–°å»ºâ€ç›¸å…³å›¾æ ‡ |
| `ic_toolbar_settings` | `drawable/` | é¡¶éƒ¨â€œè®¾ç½®â€æŒ‰é’® | `toolbar_menu.xml` | ç”¨é½¿è½®ç±» PNG |
| `ic_nav_templates` | `drawable/` | ä¾§è¾¹æ â€œå¯¹è¯æ¨¡æ¿â€ | `nav_drawer.xml` | ç”¨æ–‡æ¡£/åˆ—è¡¨ç±»å›¾æ ‡ |
| `ic_nav_routing` | `drawable/` | ä¾§è¾¹æ â€œæ™ºèƒ½è·¯ç”±â€ | `nav_drawer.xml` | ç”¨åˆ†æ”¯/ç®­å¤´ç±»å›¾æ ‡ |
| `ic_nav_graph` | `drawable/` | ä¾§è¾¹æ â€œå¯¹è¯å›¾è°±â€ | `nav_drawer.xml` | ç”¨ç½‘ç»œ/å›¾è°±ç±»å›¾æ ‡ |
| `ic_nav_settings` | `drawable/` | ä¾§è¾¹æ â€œè®¾ç½®â€ | `nav_drawer.xml` | åŒæ ·ç”¨é½¿è½®å›¾æ ‡ |
| `ic_nav_logout` | `drawable/` | ä¾§è¾¹æ â€œé€€å‡ºç™»å½•â€ | `nav_drawer.xml` | ç”¨é—¨/é€€å‡ºç®­å¤´ç­‰çº¢è‰²å›¾æ ‡ |

æŒ‰è¡¨æ›¿æ¢åŒåæ–‡ä»¶å³å¯ï¼Œå¸ƒå±€å¼•ç”¨æ— éœ€æ”¹åŠ¨ã€‚

### 9.3 ç”¨ PNG ä¸€æ­¥æ­¥æ›¿æ¢æ‰€æœ‰ç•Œé¢å›¾æ ‡ï¼ˆå®æˆ˜æ•™ç¨‹ï¼‰

è¿™é‡Œä»¥å‡ ç±»å…¸å‹å›¾æ ‡ä¸ºä¾‹ï¼š**èŠå¤©åŒºåŸŸæŒ‰é’®**ã€**åº•éƒ¨ TabBar å›¾æ ‡**ã€**é¡¶éƒ¨å·¥å…·æ æŒ‰é’®**ã€**ä¾§è¾¹æ èœå•å›¾æ ‡**ã€‚æ‰€æœ‰å›¾æ ‡çš„æœ¬è´¨æ“ä½œæ˜¯ä¸€æ ·çš„ï¼šç”¨ Image Asset æŠŠå¯¹åº”çš„ `ic_xxx` åç§°æ›¿æ¢æˆä½ çš„ PNGã€‚

#### 9.3.1 æ›¿æ¢èŠå¤©è¾“å…¥æ¡†çš„"å›¾ç‰‡"æŒ‰é’®å›¾æ ‡ï¼ˆic_attachï¼‰

1. åœ¨ç”µè„‘ä¸Šå‡†å¤‡ä¸€å¼ å°å›¾æ ‡ PNGï¼Œæ¯”å¦‚ 96Ã—96 æˆ– 128Ã—128ï¼Œæ”¾åœ¨ `D:\my_icons\attach.png`ã€‚
2. åœ¨ Android Studio å·¦ä¾§ `Project` é¢æ¿ä¸­ï¼š
   - å±•å¼€ `app/src/main/res/drawable/`
   - æ‰¾åˆ° `ic_attach.xml`ã€‚
3. å³é”® `drawable` ç›®å½• â†’ `New` â†’ `Image Asset`ï¼ˆæœ‰äº›ç‰ˆæœ¬æ˜¯ `New` â†’ `Vector Asset`ï¼Œä¸å½±å“ï¼‰ã€‚
4. åœ¨å¼¹çª—ä¸­ï¼š
   - `Icon Type` é€‰æ‹© **Action Bar and Tab Icons** æˆ– **Launcher Icons (Legacy Only)**ï¼ˆéƒ½å¯ä»¥ï¼Œæœ¬è´¨æ˜¯ç”Ÿæˆä¸€ä¸ªå°å›¾æ ‡ï¼‰ã€‚
   - `Name` å¡«å†™ï¼š**ic_attach**ï¼ˆä¸€å®šè¦å’ŒåŸæ¥çš„æ–‡ä»¶åä¸€æ ·ï¼Œè¿™æ ·å¸ƒå±€ä¸ç”¨æ”¹ï¼‰ã€‚
   - æºå›¾é€‰æ‹©ä½ çš„ `attach.png`ã€‚
   - å¤§å°ä¸€èˆ¬é€‰ 24dp æˆ– 32dpï¼Œé¢„è§ˆé‡Œçœ‹ç€åˆé€‚å³å¯ã€‚
5. ç‚¹å‡» `Next` â†’ `Finish`ã€‚  
   Android Studio ä¼šè‡ªåŠ¨åœ¨ `drawable/` ä¸‹ç”Ÿæˆæˆ–è¦†ç›– `ic_attach.png` / `ic_attach.xml` ç­‰èµ„æºï¼Œå¸ƒå±€é‡Œå¼•ç”¨çš„ `@drawable/ic_attach` è‡ªåŠ¨å˜æˆä½ çš„å›¾æ ‡ã€‚

#### 9.3.1.1 æ›¿æ¢èŠå¤©è¾“å…¥æ¡†çš„"å‘é€"å’Œ"å›¾ç‰‡"æŒ‰é’®å›¾æ ‡ï¼ˆic_send / ic_attachï¼‰

**é‡è¦**ï¼šå‘é€å’Œå›¾ç‰‡æŒ‰é’®ç°åœ¨æ˜¯**æ— èƒŒæ™¯çš„å›¾æ ‡æŒ‰é’®**ï¼ˆImageButtonï¼‰ï¼Œä¸å·¥å…·æ çš„"è®¾ç½®"å’Œ"æ–°å¯¹è¯"æŒ‰é’®æ ·å¼ä¸€è‡´ã€‚

**æŒ‰é’®æ ·å¼è¯´æ˜**ï¼š
- ä½¿ç”¨ `ImageButton` æ§ä»¶ï¼Œæ— èƒŒæ™¯è‰²
- ç‚¹å‡»æ—¶æœ‰æ³¢çº¹æ•ˆæœï¼ˆ`selectableItemBackgroundBorderless`ï¼‰
- å›¾æ ‡å°ºå¯¸ï¼š32dpï¼ˆæŒ‰é’®å°ºå¯¸ 56Ã—56dpï¼Œpadding 12dpï¼‰
- å›¾ç‰‡æŒ‰é’®å›¾æ ‡é¢œè‰²ï¼šä¸»é¢˜è‰²ï¼ˆ`@color/text_primary`ï¼‰
- å‘é€æŒ‰é’®å›¾æ ‡é¢œè‰²ï¼šä¸»è‰²è°ƒï¼ˆ`@color/primary`ï¼‰

**æ›¿æ¢æ­¥éª¤**ï¼š

1. **æ›¿æ¢"å›¾ç‰‡"æŒ‰é’®å›¾æ ‡ï¼ˆic_attachï¼‰**ï¼š
   - å‡†å¤‡ä¸€å¼ é™„ä»¶/å›¾ç‰‡å›¾æ ‡ PNGï¼Œå»ºè®® 128Ã—128ï¼Œæ”¾åœ¨ `D:\my_icons\attach.png`
   - å³é”® `drawable` ç›®å½• â†’ `New` â†’ `Image Asset`
   - `Icon Type` é€‰æ‹© **Action Bar and Tab Icons**
   - `Name` å¡«å†™ï¼š**ic_attach**
   - æºå›¾é€‰æ‹©ä½ çš„ `attach.png`
   - å¤§å°é€‰ 32dpï¼ˆå›¾æ ‡ä¼šæ˜¾ç¤ºåœ¨ 56Ã—56dp çš„æŒ‰é’®ä¸­ï¼‰
   - ç‚¹å‡» `Next` â†’ `Finish`

2. **æ›¿æ¢"å‘é€"æŒ‰é’®å›¾æ ‡ï¼ˆic_sendï¼‰**ï¼š
   - å‡†å¤‡ä¸€å¼ å‘é€å›¾æ ‡ PNGï¼Œå»ºè®® 128Ã—128ï¼Œæ”¾åœ¨ `D:\my_icons\send.png`
   - å³é”® `drawable` ç›®å½• â†’ `New` â†’ `Image Asset`
   - `Icon Type` é€‰æ‹© **Action Bar and Tab Icons**
   - `Name` å¡«å†™ï¼š**ic_send**
   - æºå›¾é€‰æ‹©ä½ çš„ `send.png`
   - å¤§å°é€‰ 32dp
   - ç‚¹å‡» `Next` â†’ `Finish`

**æ³¨æ„**ï¼š
- å›¾æ ‡ä¼šä»¥ä¸»é¢˜è‰²æˆ–ä¸»è‰²è°ƒæ˜¾ç¤ºï¼ˆé€šè¿‡ `app:tint` å±æ€§æ§åˆ¶ï¼‰ï¼Œå»ºè®®ä½¿ç”¨å•è‰²å›¾æ ‡æˆ–é€æ˜èƒŒæ™¯çš„å›¾æ ‡
- å¦‚æœå¸Œæœ›å›¾æ ‡ä¿æŒåŸå§‹é¢œè‰²ï¼Œå¯ä»¥åœ¨å¸ƒå±€æ–‡ä»¶ä¸­ç§»é™¤ `app:tint` å±æ€§

#### 9.3.1.2 æ›¿æ¢"æˆ‘çš„"é¡µé¢ç”¨æˆ·å¤´åƒï¼ˆic_user_avatarï¼‰

1. å‡†å¤‡ä¸€å¼ ç”¨æˆ·å¤´åƒ PNGï¼Œå»ºè®® 256Ã—256 æˆ–æ›´å¤§ï¼ˆæ–¹å½¢ï¼‰ï¼Œæ”¾åœ¨ `D:\my_icons\user_avatar.png`ã€‚
2. å³é”® `drawable` ç›®å½• â†’ `New` â†’ `Image Asset`ã€‚
3. åœ¨å¼¹çª—ä¸­ï¼š
   - `Icon Type` é€‰æ‹© **Action Bar and Tab Icons** æˆ– **Launcher Icons (Legacy Only)**ã€‚
   - `Name` å¡«å†™ï¼š**ic_user_avatar**ã€‚
   - æºå›¾é€‰æ‹©ä½ çš„ `user_avatar.png`ã€‚
   - å¤§å°é€‰ 80dpï¼ˆä¸å¸ƒå±€ä¸­çš„ ImageView å°ºå¯¸ä¸€è‡´ï¼‰ã€‚
4. ç‚¹å‡» `Next` â†’ `Finish`ã€‚

**æç¤º**ï¼šå¤´åƒä¼šä»¥ `centerCrop` æ¨¡å¼æ˜¾ç¤ºï¼Œå»ºè®®ä½¿ç”¨åœ†å½¢æˆ–æ–¹å½¢å¤´åƒï¼Œç¡®ä¿ä¸»ä½“åœ¨ä¸­å¿ƒä½ç½®ã€‚

#### 9.3.1.3 æ›¿æ¢å¯¹è¯æ¨¡æ¿å›¾æ ‡ï¼ˆic_template_code / ic_template_paper / ic_template_medical / ic_template_translateï¼‰

å¯¹è¯æ¨¡æ¿ç•Œé¢æœ‰ 4 ä¸ªæ¨¡æ¿ï¼Œæ¯ä¸ªæ¨¡æ¿éƒ½æœ‰ç‹¬ç«‹çš„å›¾æ ‡ï¼š

- `ic_template_code` â†’ "ç¼–ç¨‹åŠ©æ‰‹"æ¨¡æ¿å›¾æ ‡
- `ic_template_paper` â†’ "è®ºæ–‡åŠ©æ‰‹"æ¨¡æ¿å›¾æ ‡  
- `ic_template_medical` â†’ "åŒ»ç–—å’¨è¯¢"æ¨¡æ¿å›¾æ ‡
- `ic_template_translate` â†’ "ç¿»è¯‘ä¸“å®¶"æ¨¡æ¿å›¾æ ‡

**æ›¿æ¢æ­¥éª¤**ï¼ˆæ¯ä¸ªå›¾æ ‡é‡å¤ä¸€æ¬¡ï¼‰ï¼š

1. å‡†å¤‡ 4 å¼ å¯¹åº”çš„ PNG å›¾æ ‡ï¼Œå»ºè®® 128Ã—128ï¼Œåˆ†åˆ«å‘½åä¸ºï¼š
   - `template_code.png`ï¼ˆç¼–ç¨‹ç›¸å…³å›¾æ ‡ï¼Œå¦‚ä»£ç ç¬¦å·ã€é”®ç›˜ç­‰ï¼‰
   - `template_paper.png`ï¼ˆæ–‡æ¡£ç›¸å…³å›¾æ ‡ï¼Œå¦‚çº¸å¼ ã€æ–‡æ¡£ç­‰ï¼‰
   - `template_medical.png`ï¼ˆåŒ»ç–—ç›¸å…³å›¾æ ‡ï¼Œå¦‚åŒ»ç–—åå­—ã€å¬è¯Šå™¨ç­‰ï¼‰
   - `template_translate.png`ï¼ˆç¿»è¯‘ç›¸å…³å›¾æ ‡ï¼Œå¦‚è¯­è¨€ç¬¦å·ã€åœ°çƒç­‰ï¼‰
2. å¯¹æ¯ä¸ªå›¾æ ‡ï¼Œå³é”® `drawable` â†’ `New` â†’ `Image Asset`ï¼š
   - `Name` åˆ†åˆ«å¡«å†™ï¼š`ic_template_code`ã€`ic_template_paper`ã€`ic_template_medical`ã€`ic_template_translate`
   - æºå›¾é€‰æ‹©å¯¹åº”çš„ PNG
   - å¤§å°é€‰ 40dpï¼ˆä¸å¸ƒå±€ä¸­çš„ ImageView å°ºå¯¸ä¸€è‡´ï¼‰
3. æ¯ä¸ªéƒ½ç‚¹å‡» `Next` â†’ `Finish`ã€‚

å®Œæˆåï¼Œå¯¹è¯æ¨¡æ¿ç•Œé¢ä¸­çš„ 4 ä¸ªæ¨¡æ¿å¡ç‰‡ä¼šæ˜¾ç¤ºä½ è‡ªå®šä¹‰çš„å›¾æ ‡ã€‚

#### 9.3.2 æ›¿æ¢ AI å¤´åƒå ä½å›¾æ ‡ï¼ˆic_ai_avatar_placeholderï¼‰

æ­¥éª¤å’Œä¸Šé¢å‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼š

1. å‡†å¤‡ PNGï¼Œæ¯”å¦‚ 128Ã—128ï¼Œæ”¾åˆ°ä¸€ä¸ªæ˜“æ‰¾çš„ç›®å½•ã€‚
2. å³é”® `drawable` â†’ `New` â†’ `Image Asset`ã€‚
3. `Name` å¡«ï¼š**ic_ai_avatar_placeholder**ã€‚
4. é€‰æ‹©ä½ çš„ PNGï¼Œè°ƒæ•´å¤§å°ï¼Œ`Finish`ã€‚

> ä½ å¯ä»¥å¯¹ç…§ 9.2 è¡¨æ ¼ï¼ŒæŠŠå…¶ä¸­æ‰€æœ‰çš„ `ic_xxx` å›¾æ ‡éƒ½æŒ‰è¿™ä¸€å¥—æ–¹æ³•æ¢ä¸€éï¼Œåªè¦**åå­—ä¸æ”¹**ï¼Œå¸ƒå±€å’Œä»£ç å°±éƒ½ä¸ç”¨åŠ¨ã€‚

#### 9.3.3 æ›¿æ¢åº•éƒ¨ TabBar å›¾æ ‡ï¼ˆèŠå¤© / å†å² / æˆ‘çš„ï¼‰

å¯¹åº”çš„èµ„æºååˆ†åˆ«æ˜¯ï¼š

- `ic_tab_chat`    â†’ åº•éƒ¨â€œèŠå¤©â€å›¾æ ‡
- `ic_tab_history` â†’ åº•éƒ¨â€œå†å²â€å›¾æ ‡
- `ic_tab_profile` â†’ åº•éƒ¨â€œæˆ‘çš„â€å›¾æ ‡

æ“ä½œæ­¥éª¤å’Œå‰é¢å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯ **Name æ”¹æˆå¯¹åº”åå­—**ï¼š

1. å‡†å¤‡ 3 å¼  PNGï¼ˆå»ºè®® 96Ã—96 æˆ– 128Ã—128ï¼‰ï¼Œæ¯”å¦‚ `tab_chat.png` / `tab_history.png` / `tab_profile.png`ã€‚
2. å³é”® `drawable` â†’ `New` â†’ `Image Asset`ã€‚
3. `Icon Type` é€‰æ‹© Action Bar / å°å›¾æ ‡ç±»å‹å³å¯ã€‚
4. ç¬¬ä¸€æ¬¡ï¼š
   - `Name` å¡«ï¼š`ic_tab_chat`
   - é€‰æ‹© `tab_chat.png`ã€‚
5. ç¬¬äºŒæ¬¡ï¼š
   - `Name` å¡«ï¼š`ic_tab_history`
   - é€‰æ‹© `tab_history.png`ã€‚
6. ç¬¬ä¸‰æ¬¡ï¼š
   - `Name` å¡«ï¼š`ic_tab_profile`
   - é€‰æ‹© `tab_profile.png`ã€‚

ç”±äº `bottom_navigation.xml` é‡Œå·²ç»æ”¹æˆå¼•ç”¨ `@drawable/ic_tab_chat` ç­‰ï¼Œè¿™æ ·ä¸‰æ­¥åšå®Œï¼Œåº•éƒ¨ä¸‰ä¸ª Tab çš„å›¾æ ‡å°±å…¨éƒ¨æ¢æˆä½ çš„ PNG äº†ã€‚

#### 9.3.4 æ›¿æ¢é¡¶éƒ¨å·¥å…·æ â€œæ–°å¯¹è¯ / è®¾ç½®â€å›¾æ ‡

å¯¹åº”çš„èµ„æºåï¼š

- `ic_toolbar_new_chat`  â†’ é¡¶éƒ¨â€œæ–°å¯¹è¯â€æŒ‰é’®
- `ic_toolbar_settings`  â†’ é¡¶éƒ¨â€œè®¾ç½®â€æŒ‰é’®

æ­¥éª¤åŒä¸Šï¼š

1. å‡†å¤‡ 2 å¼  PNGï¼ˆæ¯”å¦‚â€œåŠ å·â€å›¾å’Œâ€œé½¿è½®â€å›¾ï¼‰ã€‚
2. ç”¨ Image Asset ç”Ÿæˆï¼š
   - Name = `ic_toolbar_new_chat`  â†’ é€‰æ–°å¯¹è¯å›¾æ ‡ PNGã€‚
   - Name = `ic_toolbar_settings`  â†’ é€‰è®¾ç½®å›¾æ ‡ PNGã€‚

`toolbar_menu.xml` é‡Œå·²ç»ç”¨çš„æ˜¯è¿™ä¸¤ä¸ªåå­—ï¼Œæ›¿æ¢åé‡å»ºå³å¯ç”Ÿæ•ˆã€‚

#### 9.3.5 æ›¿æ¢â€œæˆ‘çš„â€ä¾§è¾¹æ èœå•å›¾æ ‡ï¼ˆæ¨¡æ¿ / è·¯ç”± / å›¾è°± / è®¾ç½® / é€€å‡ºï¼‰

å¯¹åº”çš„èµ„æºåï¼š

- `ic_nav_templates` â†’ â€œå¯¹è¯æ¨¡æ¿â€
- `ic_nav_routing`   â†’ â€œæ™ºèƒ½è·¯ç”±â€
- `ic_nav_graph`     â†’ â€œå¯¹è¯å›¾è°±â€
- `ic_nav_settings`  â†’ â€œè®¾ç½®â€
- `ic_nav_logout`    â†’ â€œé€€å‡ºç™»å½•â€

åŒæ ·ä¸€äººä¸€é Image Assetï¼š

1. å‡†å¤‡ 5 å¼  PNGï¼ˆæ–‡æ¡£ã€åˆ†æ”¯ç®­å¤´ã€ç½‘ç»œå›¾ã€é½¿è½®ã€é€€å‡ºç®­å¤´/é—¨ç­‰ï¼‰ã€‚
2. å³é”® `drawable` â†’ `New` â†’ `Image Asset`ã€‚
3. æŒ‰ä¸Šé¢ 5 ä¸ªåå­—åˆ†åˆ«å¯¼å…¥ï¼š
   - Name = `ic_nav_templates`  â†’ é€‰æ¨¡æ¿ PNGã€‚
   - Name = `ic_nav_routing`   â†’ é€‰è·¯ç”± PNGã€‚
   - Name = `ic_nav_graph`     â†’ é€‰å›¾è°± PNGã€‚
   - Name = `ic_nav_settings`  â†’ é€‰è®¾ç½® PNGã€‚
   - Name = `ic_nav_logout`    â†’ é€‰é€€å‡º PNGã€‚

`nav_drawer.xml` ä¸­å·²ç»æ”¹ä¸ºè¿™äº›èµ„æºåï¼Œå¯¼å…¥å®Œæˆåï¼Œæ‰“å¼€ä¾§è¾¹æ å°±èƒ½çœ‹åˆ°æ›¿æ¢åçš„æ•ˆæœã€‚

### 9.4 å…¶ä»–å›¾ç‰‡èµ„æºåŠå°ºå¯¸ï¼ˆç®€å•è®°ï¼‰

- å¦‚æœä½ æœ‰æ•´å±æ’ç”»ï¼ˆæ¯”å¦‚ç©ºç™½é¡µçš„å¤§å›¾ï¼‰ï¼Œåªè¦æ”¾åˆ° `drawable/` ç›®å½•ï¼Œå‘½åæˆå¥½è®°çš„åå­—ï¼Œæ¯”å¦‚ `empty_state.png`ï¼Œç„¶ååœ¨å¯¹åº”å¸ƒå±€ï¼ˆå¦‚ `fragment_history.xml`ï¼‰é‡ŒæŠŠ `android:text="ğŸ˜”"` æ”¹æˆä¸€ä¸ª `ImageView` å¼•ç”¨ä½ çš„ `@drawable/empty_state` å³å¯ã€‚
- å¸¸ç”¨å°ºå¯¸å»ºè®®ï¼š

| ç”¨é€” | æ¨èå°ºå¯¸ | ç›®å½• |
| --- | --- | --- |
| å¯åŠ¨é¡µ/ç©ºæ€æ’ç”» | 1080Ã—1920 PNG/WebP | `drawable/` |
| ç”¨æˆ·/AI å¤´åƒ | 64Ã—64 PNG | `drawable/` |
| å°æŒ‰é’®å›¾æ ‡ | 96Ã—96 PNG | é€šè¿‡ Image Asset ç”Ÿæˆ 24dp å›¾æ ‡ |
| èŠå¤©æ°”æ³¡èƒŒæ™¯ | å»ºè®®ç”¨ Shape XMLï¼ˆä¸ç”¨ PNGï¼‰ | `drawable/` |

### 9.5 æ›´æ¢å›¾æ ‡ Checklistï¼ˆç…§ç€å‹¾å°±è¡Œï¼‰

1. **æ¡Œé¢å›¾æ ‡**ï¼šæŒ‰ 9.1.2 ç”¨ Image Asset è·‘ä¸€é `ic_launcher`ã€‚
2. **èŠå¤©é¡µå›¾æ ‡**ï¼šæŒ‰ 9.3.1ã€9.3.2 çš„æ–¹æ³•ï¼ŒæŠŠ 9.2 è¡¨æ ¼ä¸­æ‰€æœ‰ `ic_xxx` éƒ½æ›¿æ¢ä¸€éã€‚
3. **å…¶ä»–æ’ç”»**ï¼šæŠŠ PNG æ”¾åˆ° `drawable/`ï¼Œä¿®æ”¹å¯¹åº”å¸ƒå±€é‡Œçš„ `@drawable/...` å¼•ç”¨ã€‚
4. `Build` â†’ `Rebuild Project`ã€‚
5. çœŸæœº/æ¨¡æ‹Ÿå™¨è‡ªæµ‹ï¼šæ¡Œé¢ã€èŠå¤©é¡µã€å†å²é¡µã€æŠ½å±‰èœå•æ˜¯å¦éƒ½æ˜¾ç¤ºä¸ºä½ çš„ç´ æã€‚
6. æŠŠ `res/` é‡Œçš„æ”¹åŠ¨æäº¤åˆ° Gitã€‚

### 9.6 å¸¸è§é—®é¢˜ FAQ

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
| --- | --- | --- |
| æ›¿æ¢åå›¾æ ‡æ²¡å˜åŒ– | è¦†ç›–äº† `drawable/`ï¼Œä½†å¸ƒå±€å¼•ç”¨ `mipmap/` | æ£€æŸ¥å¸ƒå±€å¼•ç”¨ï¼Œå¿…è¦æ—¶æŠŠèµ„æºæ”¾åˆ°æ­£ç¡®ç›®å½• |
| SVG å¯¼å…¥å¤±è´¥ | æ–‡ä»¶åŒ…å« `clipPath` / `mask` | ç”¨ Illustrator é‡æ–°å¯¼å‡ºâ€œç®€å•è·¯å¾„â€ç‰ˆæˆ–è½¬æˆ PNG |
| é¢œè‰²ä¸å¯¹ | å¸ƒå±€å±‚è®¾ç½®äº† `android:tint` | åŒæ­¥ä¿®æ”¹å¸ƒå±€é‡Œçš„ `tint`ï¼Œæˆ–å»æ‰ `tint` ç›´æ¥åœ¨çŸ¢é‡é‡Œè®¾è‰² |
| APK ä½“ç§¯æš´å¢ | å¯¼å…¥äº†å¤šå¥—å¤§å›¾ | æ”¹ç”¨ SVG/WebPï¼Œåˆ é™¤æœªä½¿ç”¨çš„å¯†åº¦å˜ä½“ |



## 10. XML æ–‡ä»¶é—®é¢˜æ’æŸ¥

### 10.1 "Valid XML document must have a root tag" é”™è¯¯

å¦‚æœé‡åˆ°æ­¤é”™è¯¯ï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

1. **æ£€æŸ¥ XML æ–‡ä»¶æ˜¯å¦å®Œæ•´**
   - ç¡®ä¿æ¯ä¸ª XML æ–‡ä»¶éƒ½æœ‰æ­£ç¡®çš„æ ¹æ ‡ç­¾
   - ç¡®ä¿ XML æ–‡ä»¶æ²¡æœ‰è¢«æˆªæ–­

2. **å¸¸è§é—®é¢˜æ–‡ä»¶**
   - `app/src/main/res/xml/data_extraction_rules.xml`
   - `app/src/main/res/xml/backup_rules.xml`
   - `app/src/main/res/mipmap-anydpi-v26/ic_launcher.xml`
   - `app/src/main/res/mipmap-anydpi-v26/ic_launcher_round.xml`

3. **è§£å†³æ–¹æ³•**
   - åœ¨ Android Studio ä¸­ï¼Œé€‰æ‹© `File` â†’ `Invalidate Caches / Restart`
   - æ¸…ç†é¡¹ç›®: `Build` â†’ `Clean Project`
   - é‡æ–°æ„å»º: `Build` â†’ `Rebuild Project`

4. **éªŒè¯ XML æ–‡ä»¶**
   - ç¡®ä¿æ‰€æœ‰ XML æ–‡ä»¶éƒ½ä»¥ `<?xml version="1.0" encoding="utf-8"?>` å¼€å¤´
   - ç¡®ä¿æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ ¹å…ƒç´ 
   - ç¡®ä¿æ‰€æœ‰æ ‡ç­¾éƒ½æ­£ç¡®é—­åˆ



## 11. é…ç½®è¯´æ˜

### 11.1 ç½‘ç»œæƒé™

ç¡®ä¿ `AndroidManifest.xml` ä¸­åŒ…å«ç½‘ç»œæƒé™:

```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
```

### 11.2 åº”ç”¨é…ç½®

**åº”ç”¨ ID**: `com.example.dreamaichat_app`

å¦‚éœ€ä¿®æ”¹ï¼Œç¼–è¾‘ `app/build.gradle.kts`:
```kotlin
defaultConfig {
    applicationId = "com.yourcompany.dreamaichat_app"
    // ...
}
```

**ç‰ˆæœ¬ä¿¡æ¯**:
- Version Code: 1
- Version Name: "1.0"

### 11.3 ç­¾åé…ç½®ï¼ˆRelease æ„å»ºï¼‰

1. **ç”Ÿæˆå¯†é’¥åº“**
   ```bash
   keytool -genkey -v -keystore dreamai-release.jks -keyalg RSA -keysize 2048 -validity 10000 -alias dreamai
   ```

2. **é…ç½®ç­¾å**
   åœ¨ `app/build.gradle.kts` ä¸­æ·»åŠ :
   ```kotlin
   android {
       signingConfigs {
           create("release") {
               storeFile = file("path/to/keystore.jks")
               storePassword = "your-store-password"
               keyAlias = "dreamai"
               keyPassword = "your-key-password"
           }
       }
       buildTypes {
           release {
               signingConfig = signingConfigs.getByName("release")
               // ...
           }
       }
   }
   ```



## 12. å¼€å‘å»ºè®®

### 12.1 ä»£ç è§„èŒƒ

- éµå¾ª Java ç¼–ç è§„èŒƒ
- ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å’Œæ–¹æ³•å
- æ·»åŠ å¿…è¦çš„æ³¨é‡Š
- ä¿æŒä»£ç ç®€æ´

### 12.2 è°ƒè¯•æŠ€å·§

1. **ä½¿ç”¨ Logcat**
   - æŸ¥çœ‹åº”ç”¨æ—¥å¿—
   - è¿‡æ»¤ç‰¹å®šæ ‡ç­¾
   - æœç´¢é”™è¯¯ä¿¡æ¯

2. **ä½¿ç”¨æ–­ç‚¹**
   - åœ¨å…³é”®ä»£ç å¤„è®¾ç½®æ–­ç‚¹
   - ä½¿ç”¨è°ƒè¯•æ¨¡å¼è¿è¡Œåº”ç”¨
   - æ£€æŸ¥å˜é‡å€¼

3. **ä½¿ç”¨ Android Profiler**
   - ç›‘æ§ CPU ä½¿ç”¨
   - ç›‘æ§å†…å­˜ä½¿ç”¨
   - ç›‘æ§ç½‘ç»œè¯·æ±‚

### 12.3 æµ‹è¯•

1. **å•å…ƒæµ‹è¯•**
   - æµ‹è¯• UseCase å’Œ Repository
   - ä½¿ç”¨ JUnit å’Œ Mockito

2. **UI æµ‹è¯•**
   - ä½¿ç”¨ Espresso è¿›è¡Œ UI æµ‹è¯•
   - æµ‹è¯•å…³é”®ç”¨æˆ·æµç¨‹



## 13. å‘å¸ƒå‡†å¤‡

### 13.1 ä»£ç æ··æ·†

åœ¨ `app/proguard-rules.pro` ä¸­æ·»åŠ æ··æ·†è§„åˆ™:

```proguard
# Retrofit
-keepattributes Signature, InnerClasses
-keepattributes RuntimeVisibleAnnotations, RuntimeVisibleParameterAnnotations
-keepclassmembers,allowshrinking,allowobfuscation interface * {
    @retrofit2.http.* <methods>;
}

# Room
-keep class * extends androidx.room.RoomDatabase
-keep @androidx.room.Entity class *
```

### 13.2 èµ„æºä¼˜åŒ–

1. **ç§»é™¤æœªä½¿ç”¨çš„èµ„æº**
   
   ```bash
   ./gradlew clean
   ```
   
2. **å‹ç¼©å›¾ç‰‡èµ„æº**
   - ä½¿ç”¨ WebP æ ¼å¼
   - ä½¿ç”¨é€‚å½“çš„å›¾ç‰‡å°ºå¯¸

### 13.3 æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨ ProGuard**
   ```kotlin
   buildTypes {
       release {
           isMinifyEnabled = true
           proguardFiles(getDefaultProguardFile("proguard-android-optimize.txt"), "proguard-rules.pro")
       }
   }
   ```

2. **å¯ç”¨èµ„æºå‹ç¼©**
   ```kotlin
   buildTypes {
       release {
           isShrinkResources = true
       }
   }
   ```


