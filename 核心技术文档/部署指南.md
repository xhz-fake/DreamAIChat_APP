# DreamAIChat_APP éƒ¨ç½²æ–‡æ¡£

## 1. ç¯å¢ƒè¦æ±‚

### 1.1 å¼€å‘ç¯å¢ƒ

- **æ“ä½œç³»ç»Ÿ**: Windows 10/11, macOS, æˆ– Linux
- **JDK**: JDK 11 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Android Studio**: Arctic Fox (2020.3.1) æˆ–æ›´é«˜ç‰ˆæœ¬
- **Gradle**: 8.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆé¡¹ç›®å·²åŒ…å« Gradle Wrapperï¼‰
- **Android SDK**: API 21 (Android 5.0) æˆ–æ›´é«˜ç‰ˆæœ¬

### 1.2 ç¡¬ä»¶è¦æ±‚

- **å†…å­˜**: è‡³å°‘ 8GB RAMï¼ˆæ¨è 16GBï¼‰
- **å­˜å‚¨ç©ºé—´**: è‡³å°‘ 10GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: éœ€è¦ç¨³å®šçš„ç½‘ç»œè¿æ¥ä»¥ä¸‹è½½ä¾èµ–

## 2. é¡¹ç›®ç»“æ„

> å½“å‰å¯ç”¨ä»£ç ä½äº `D:\ProgramFiles\CodeProjects\Android\projects\DreamAIChat\DreamAIChat_APP`ã€‚
```
DreamAIChat_APP/
â”œâ”€â”€ app/                          # åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”‚   â”œâ”€â”€ java/            # Java æºä»£ç 
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ com/example/dreamaichat_app/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ data/    # æ•°æ®å±‚
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ domain/ # é¢†åŸŸå±‚
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ mvi/    # MVI æ¶æ„åŸºç¡€
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ presentation/ # è¡¨ç°å±‚
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ ui/     # UI å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ res/            # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ AndroidManifest.xml
â”‚   â”‚   â””â”€â”€ test/               # æµ‹è¯•ä»£ç 
â”‚   â””â”€â”€ build.gradle.kts        # æ¨¡å—æ„å»ºé…ç½®
â”œâ”€â”€ gradle/                     # Gradle é…ç½®
â”‚   â””â”€â”€ libs.versions.toml     # ä¾èµ–ç‰ˆæœ¬ç®¡ç†
â”œâ”€â”€ build.gradle.kts            # é¡¹ç›®æ„å»ºé…ç½®
â”œâ”€â”€ settings.gradle.kts         # é¡¹ç›®è®¾ç½®
â””â”€â”€ gradlew                     # Gradle Wrapper (Unix)
```

## 3. å®‰è£…æ­¥éª¤

### 3.1 å…‹éš†é¡¹ç›®

```bash
# å¦‚æœé¡¹ç›®åœ¨ Git ä»“åº“ä¸­
git clone <repository-url>
cd DreamAIChat_APP
```

### 3.2 é…ç½® Android Studio

1. **æ‰“å¼€é¡¹ç›®**
   - å¯åŠ¨ Android Studio
   - é€‰æ‹© `File` â†’ `Open`
   - é€‰æ‹©é¡¹ç›®æ ¹ç›®å½•

2. **åŒæ­¥ Gradle**
   - Android Studio ä¼šè‡ªåŠ¨æ£€æµ‹é¡¹ç›®å¹¶æç¤ºåŒæ­¥
   - ç‚¹å‡» `Sync Now` æˆ–ç­‰å¾…è‡ªåŠ¨åŒæ­¥å®Œæˆ
   - é¦–æ¬¡åŒæ­¥å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼ˆä¸‹è½½ä¾èµ–ï¼‰

3. **é…ç½® SDK**
   - æ‰“å¼€ `File` â†’ `Project Structure` â†’ `SDK Location`
   - ç¡®ä¿å·²å®‰è£… Android SDK Platform 21 æˆ–æ›´é«˜ç‰ˆæœ¬
   - ç¡®ä¿å·²å®‰è£… Android SDK Build-Tools

### 3.3 é…ç½® API åœ°å€

#### 3.3.1 ä»€ä¹ˆæ˜¯ API åœ°å€ï¼Ÿ

API åœ°å€ï¼ˆä¹Ÿå« Base URLï¼‰æ˜¯ä½ çš„åç«¯æœåŠ¡å™¨åœ°å€ã€‚å½“åº”ç”¨éœ€è¦è·å–æ•°æ®æˆ–å‘é€æ•°æ®æ—¶ï¼Œä¼šå‘è¿™ä¸ªåœ°å€å‘é€ HTTP è¯·æ±‚ã€‚

**ç®€å•ç†è§£**ï¼š

- å°±åƒä½ å®¶çš„åœ°å€ä¸€æ ·ï¼ŒAPI åœ°å€å‘Šè¯‰åº”ç”¨"å»å“ªé‡Œæ‰¾æ•°æ®"
- ä¾‹å¦‚ï¼š`https://api.example.com/` å°±æ˜¯æœåŠ¡å™¨çš„åœ°å€
- å…·ä½“çš„æ¥å£ï¼ˆå¦‚ç™»å½•ã€å‘é€æ¶ˆæ¯ï¼‰ä¼šåœ¨è¿™ä¸ªåœ°å€åé¢æ·»åŠ è·¯å¾„

#### 3.3.2 é…ç½®æ­¥éª¤

**æ­¥éª¤ 1ï¼šæ‰¾åˆ°é…ç½®æ–‡ä»¶**

1. åœ¨ Android Studio å·¦ä¾§çš„ `Project` é¢æ¿ä¸­ï¼Œæ‰¾åˆ°ä»¥ä¸‹è·¯å¾„ï¼š
   ```
   app â†’ src â†’ main â†’ java â†’ com â†’ example â†’ dreamaichat_app â†’ data â†’ remote â†’ RetrofitClient.java
   ```
2. åŒå‡»æ‰“å¼€ `RetrofitClient.java` æ–‡ä»¶

**æ­¥éª¤ 2ï¼šä¿®æ”¹ BASE_URL**

åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°è¿™ä¸€è¡Œï¼ˆå¤§çº¦åœ¨ç¬¬ 30 è¡Œå·¦å³ï¼‰ï¼š
```java
private static final String BASE_URL = "https://api.example.com/";
```

å°† `https://api.example.com/` æ›¿æ¢ä¸ºä½ çš„å®é™… API åœ°å€ã€‚

**é‡è¦æç¤º**ï¼š

- âœ… åœ°å€å¿…é¡»ä»¥ `http://` æˆ– `https://` å¼€å¤´
- âœ… åœ°å€æœ«å°¾å¿…é¡»æœ‰æ–œæ  `/`
- âœ… ä¸è¦åŒ…å«å…·ä½“çš„æ¥å£è·¯å¾„ï¼ˆå¦‚ `/auth/login`ï¼‰ï¼Œåªå†™åŸºç¡€åœ°å€
- âŒ é”™è¯¯ç¤ºä¾‹ï¼š`api.example.com`ï¼ˆç¼ºå°‘åè®®ï¼‰
- âŒ é”™è¯¯ç¤ºä¾‹ï¼š`https://api.example.com`ï¼ˆç¼ºå°‘æœ«å°¾æ–œæ ï¼‰
- âœ… æ­£ç¡®ç¤ºä¾‹ï¼š`https://api.example.com/`

#### 3.3.3 ä¸åŒåœºæ™¯çš„é…ç½®æ–¹æ³•

**åœºæ™¯ 1ï¼šä½¿ç”¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨**

å¦‚æœä½ åœ¨æœ¬åœ°è¿è¡Œåç«¯æœåŠ¡å™¨ï¼ˆå¦‚ä½¿ç”¨ Spring Bootã€Node.js ç­‰ï¼‰ï¼š

```java
// å¦‚æœä½¿ç”¨ Android æ¨¡æ‹Ÿå™¨ï¼Œä½¿ç”¨ 10.0.2.2 ä»£æ›¿ localhost
private static final String BASE_URL = "http://10.0.2.2:8081/";

// å¦‚æœä½¿ç”¨çœŸæœºè°ƒè¯•ï¼Œä½¿ç”¨ç”µè„‘çš„ IP åœ°å€ï¼ˆåœ¨ cmd ä¸­è¾“å…¥ ipconfig æŸ¥çœ‹ï¼‰
private static final String BASE_URL = "http://192.168.1.100:8081/";
```

**å¦‚ä½•æŸ¥çœ‹ç”µè„‘ IP åœ°å€**ï¼š
- Windowsï¼šæ‰“å¼€å‘½ä»¤æç¤ºç¬¦ï¼ˆcmdï¼‰ï¼Œè¾“å…¥ `ipconfig`ï¼Œæ‰¾åˆ° "IPv4 åœ°å€"
- Mac/Linuxï¼šæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ `ifconfig`ï¼Œæ‰¾åˆ° "inet" åœ°å€

**åœºæ™¯ 2ï¼šä½¿ç”¨æµ‹è¯•æœåŠ¡å™¨**

å¦‚æœä½ æœ‰æµ‹è¯•ç¯å¢ƒçš„æœåŠ¡å™¨åœ°å€ï¼š

```java
private static final String BASE_URL = "https://test-api.yourcompany.com/";
```

**åœºæ™¯ 3ï¼šä½¿ç”¨ç”Ÿäº§æœåŠ¡å™¨**

æ­£å¼å‘å¸ƒæ—¶ä½¿ç”¨ï¼š

```java
private static final String BASE_URL = "https://api.yourcompany.com/";
```

**åœºæ™¯ 4ï¼šæš‚æ—¶æ²¡æœ‰åç«¯æœåŠ¡å™¨ï¼ˆå¼€å‘æµ‹è¯•ï¼‰**

å¦‚æœä½ è¿˜æ²¡æœ‰åç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥ï¼š

1. **ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®**ï¼ˆæ¨èç”¨äº UI å¼€å‘ï¼‰
   - æš‚æ—¶ä¸ä¿®æ”¹ BASE_URL
   - åœ¨ `LoginUseCase` å’Œ `SendMessageUseCase` ä¸­è¿”å›æ¨¡æ‹Ÿæ•°æ®
   - è¿™æ ·å¯ä»¥å…ˆå®Œæˆç•Œé¢å¼€å‘

2. **ä½¿ç”¨å…¬å…±æµ‹è¯• API**
   - å¯ä»¥ä½¿ç”¨ä¸€äº›å…è´¹çš„æµ‹è¯• API æœåŠ¡
   - ä¾‹å¦‚ï¼š`https://jsonplaceholder.typicode.com/`ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œä¸æ˜¯çœŸå®åŠŸèƒ½ï¼‰

#### 3.3.4 é…ç½®ç¤ºä¾‹

**å®Œæ•´é…ç½®ç¤ºä¾‹**ï¼š

```java
public class RetrofitClient {
    // å¼€å‘ç¯å¢ƒ - æœ¬åœ°æœåŠ¡å™¨
    private static final String BASE_URL = "http://10.0.2.2:8081/";
    
    // æˆ–è€…æµ‹è¯•ç¯å¢ƒ
    // private static final String BASE_URL = "https://test-api.example.com/";
    
    // æˆ–è€…ç”Ÿäº§ç¯å¢ƒ
    // private static final String BASE_URL = "https://api.example.com/";
    
    // ... å…¶ä»–ä»£ç 
}
```

#### 3.3.5 å¦‚ä½•éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ

**æ–¹æ³• 1ï¼šæŸ¥çœ‹æ—¥å¿—**

1. è¿è¡Œåº”ç”¨
2. æ‰“å¼€ Android Studio åº•éƒ¨çš„ `Logcat` é¢æ¿
3. è¿‡æ»¤æ ‡ç­¾ï¼šè¾“å…¥ `OkHttp` æˆ– `Retrofit`
4. å¦‚æœçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„æ—¥å¿—ï¼Œè¯´æ˜é…ç½®æˆåŠŸï¼š
   ```
   D/OkHttp: --> POST https://api.example.com/auth/login
   D/OkHttp: Content-Type: application/json
   ```

**æ–¹æ³• 2ï¼šæµ‹è¯•ç™»å½•åŠŸèƒ½**

1. åœ¨åº”ç”¨ä¸­è¾“å…¥è´¦å·å¯†ç ï¼Œç‚¹å‡»ç™»å½•
2. æŸ¥çœ‹ Logcatï¼š
   - å¦‚æœçœ‹åˆ°ç½‘ç»œè¯·æ±‚æ—¥å¿—ï¼Œè¯´æ˜é…ç½®æ­£ç¡®
   - å¦‚æœçœ‹åˆ°è¿æ¥é”™è¯¯ï¼ˆå¦‚ "Failed to connect"ï¼‰ï¼Œæ£€æŸ¥ï¼š
     - API åœ°å€æ˜¯å¦æ­£ç¡®
     - æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
     - ç½‘ç»œæ˜¯å¦è¿æ¥

#### 3.3.6 å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

**é—®é¢˜ 1ï¼šè¿æ¥å¤±è´¥ï¼ˆConnection refusedï¼‰**

**åŸå› **ï¼š
- API åœ°å€é”™è¯¯
- æœåŠ¡å™¨æœªè¿è¡Œ
- é˜²ç«å¢™é˜»æ­¢è¿æ¥

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ API åœ°å€æ˜¯å¦æ­£ç¡®ï¼ˆåŒ…æ‹¬åè®®ã€ç«¯å£å·ï¼‰
2. ç¡®è®¤åç«¯æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

**é—®é¢˜ 2ï¼š404 Not Found**

**åŸå› **ï¼š
- API è·¯å¾„é”™è¯¯
- æœåŠ¡å™¨ä¸Šæ²¡æœ‰å¯¹åº”çš„æ¥å£

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `ApiService.java` ä¸­çš„æ¥å£è·¯å¾„æ˜¯å¦æ­£ç¡®
2. ä¸åç«¯å¼€å‘äººå‘˜ç¡®è®¤æ¥å£è·¯å¾„

**é—®é¢˜ 3ï¼šSSL è¯ä¹¦é”™è¯¯ï¼ˆä»… HTTPSï¼‰**

**åŸå› **ï¼š
- ä½¿ç”¨äº†è‡ªç­¾åè¯ä¹¦
- è¯ä¹¦è¿‡æœŸ

**è§£å†³æ–¹æ³•**ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰ï¼š
- æš‚æ—¶ä½¿ç”¨ HTTP åè®®ï¼ˆä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰
- æˆ–é…ç½®ä¿¡ä»»æ‰€æœ‰è¯ä¹¦ï¼ˆä»…ç”¨äºå¼€å‘æµ‹è¯•ï¼‰

#### 3.3.7 é…ç½®è®¤è¯ Tokenï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ çš„ API éœ€è¦è®¤è¯ Tokenï¼Œéœ€è¦åœ¨ç™»å½•æˆåŠŸåä¿å­˜ Tokenï¼Œç„¶ååœ¨åç»­è¯·æ±‚ä¸­ä½¿ç”¨ã€‚

**å½“å‰å®ç°**ï¼š
- Token åœ¨ `SendMessageUseCase` ä¸­ä½¿ç”¨
- ç™»å½•æˆåŠŸåï¼ŒToken åº”è¯¥ä¿å­˜åœ¨ `SharedPreferences` æˆ–æ•°æ®åº“ä¸­
- åç»­è¯·æ±‚ä¼šè‡ªåŠ¨å¸¦ä¸Š Token

**å¦‚ä½•é…ç½®**ï¼ˆå¦‚æœ Token ç®¡ç†è¿˜æœªå®ç°ï¼‰ï¼š
1. æš‚æ—¶å¯ä»¥åœ¨ `SendMessageUseCase` ä¸­ç¡¬ç¼–ç æµ‹è¯• Token
2. åç»­ä¼šå®ç°å®Œæ•´çš„ Token ç®¡ç†æœºåˆ¶

#### 3.3.8 ä¸‹ä¸€æ­¥

é…ç½®å®Œ API åœ°å€åï¼š
1. âœ… ä¿å­˜æ–‡ä»¶ï¼ˆCtrl+S æˆ– Cmd+Sï¼‰
2. âœ… åŒæ­¥é¡¹ç›®ï¼ˆç‚¹å‡» Android Studio é¡¶éƒ¨çš„ "Sync Now"ï¼‰
3. âœ… è¿è¡Œåº”ç”¨æµ‹è¯•ç½‘ç»œè¿æ¥
4. âœ… æŸ¥çœ‹ Logcat ç¡®è®¤è¯·æ±‚æ˜¯å¦å‘é€æˆåŠŸ

## 4. Spring Boot åç«¯éƒ¨ç½²ï¼ˆDreamAIChat_backendï¼‰

Android å®¢æˆ·ç«¯å·²ç»ä¸å†ä¾èµ–æ¨¡æ‹Ÿæ•°æ®ï¼Œ`DreamAIChat_backend` æä¾›çœŸå®çš„ç™»å½•ã€å¯¹è¯ã€ä¼šè¯åˆ—è¡¨ç­‰æ¥å£ã€‚æœ¬èŠ‚ç»™å‡ºæœ€å°å¯è¿è¡Œç‰ˆæœ¬çš„æ­å»ºæ­¥éª¤ï¼š

### 4.1 ç¯å¢ƒè¦æ±‚

- JDK 17ï¼ˆå»ºè®®ä½¿ç”¨ Temurin/OpenJDKï¼‰
- Gradle 8+ï¼ˆé¡¹ç›®è‡ªå¸¦ Wrapperï¼Œå¯ç›´æ¥è¿è¡Œ `./gradlew`ï¼‰
- å¯è®¿é—®å¤–ç½‘ï¼Œç”¨äºè¯·æ±‚ Doubao / DeepSeek API

### 4.2 åœ¨ IDEA ä¸­å¯åŠ¨åç«¯

**æ­¥éª¤ 1ï¼šåˆ›å»ºè¿è¡Œé…ç½®**

1. åœ¨ IDEA ä¸­æ‰“å¼€é¡¹ç›®
2. æ‰¾åˆ°ä¸»ç±»ï¼š`DreamAiChatBackendApplication.kt`
   - è·¯å¾„ï¼š`DreamAIChat_backend/src/main/kotlin/com/dreamaichat/backend/DreamAiChatBackendApplication.kt`
3. å³é”®ç‚¹å‡»ä¸»ç±»æ–‡ä»¶ï¼Œé€‰æ‹© **"Run 'DreamAiChatBackendApplication'"**
   - æˆ–è€…ç‚¹å‡»ä¸»ç±»æ–‡ä»¶å·¦ä¾§çš„ç»¿è‰²ä¸‰è§’å½¢ â–¶ï¸

**æ­¥éª¤ 2ï¼šé…ç½®è¿è¡Œå‚æ•°**

1. ç‚¹å‡» IDEA é¡¶éƒ¨å·¥å…·æ çš„ **"Run"** â†’ **"Edit Configurations..."**
2. åœ¨å·¦ä¾§æ‰¾åˆ° **"DreamAiChatBackendApplication"** é…ç½®
3. åœ¨å³ä¾§é…ç½®é¢æ¿ä¸­ï¼š

   **a. è®¾ç½® Active profilesï¼ˆé‡è¦ï¼ï¼‰**
   
   - æ‰¾åˆ° **"Active profiles"** å­—æ®µ
   - è¾“å…¥ï¼š`local`
   - æˆ–è€…åœ¨ **"VM options"** ä¸­æ·»åŠ ï¼š`-Dspring.profiles.active=local`
   
   **b. è®¾ç½®ç¯å¢ƒå˜é‡**
   
   - æ‰¾åˆ° **"Environment variables"**
   - æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼ˆå¦‚æœä½¿ç”¨ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è·³è¿‡æ­¤æ­¥ï¼‰ï¼š
     ```
     DEEPSEEK_API_KEY=sk-ä½ çš„å¯†é’¥
     DOUBAO_API_KEY=ä½ çš„è±†åŒ…å¯†é’¥
     ```

4. ç‚¹å‡» **"Apply"** â†’ **"OK"** ä¿å­˜é…ç½®

**æ­¥éª¤ 3ï¼šå¯åŠ¨åç«¯**

1. ç‚¹å‡» IDEA é¡¶éƒ¨å·¥å…·æ çš„ç»¿è‰²è¿è¡ŒæŒ‰é’® â–¶ï¸
2. æˆ–è€…æŒ‰å¿«æ·é”®ï¼š`Shift + F10`
3. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   The following profiles are active: local
   Tomcat started on port 8081
   Started DreamAiChatBackendApplication in Xs
   ```

### 4.3 é…ç½® API Keyï¼ˆç³»ç»Ÿç¯å¢ƒå˜é‡æ–¹å¼ï¼‰

**æ­¥éª¤ 1ï¼šè®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡**

1. æŒ‰ `Win + R`ï¼Œè¾“å…¥ `sysdm.cpl`ï¼Œå›è½¦
2. ç‚¹å‡» **"é«˜çº§"** â†’ **"ç¯å¢ƒå˜é‡"**
3. åœ¨ **"ç”¨æˆ·å˜é‡"** åŒºåŸŸç‚¹å‡» **"æ–°å»º"**ï¼š
   - å˜é‡åï¼š`DEEPSEEK_API_KEY`
   - å˜é‡å€¼ï¼šä½ çš„ DeepSeek API Keyï¼ˆæ ¼å¼ï¼š`sk-xxxxx`ï¼‰
4. å†æ¬¡ç‚¹å‡» **"æ–°å»º"**ï¼š
   - å˜é‡åï¼š`DOUBAO_API_KEY`
   - å˜é‡å€¼ï¼šä½ çš„è±†åŒ… API Key
5. ç‚¹å‡» **"ç¡®å®š"** ä¿å­˜

**æ­¥éª¤ 2ï¼šåœ¨ IDEA è¿è¡Œé…ç½®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡**

1. åœ¨ IDEA è¿è¡Œé…ç½®çš„ **"Environment variables"** ä¸­æ·»åŠ ï¼š
   ```
   DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
   DOUBAO_API_KEY=${DOUBAO_API_KEY}
   ```
2. æˆ–è€…ç›´æ¥å¡«å†™å®é™…å€¼ï¼ˆä¸æ¨èï¼Œå› ä¸ºä¼šä¿å­˜åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼‰

**æ­¥éª¤ 3ï¼šé‡å¯åç«¯æœåŠ¡**

1. åœæ­¢å½“å‰è¿è¡Œçš„åç«¯ï¼ˆå¦‚æœæ­£åœ¨è¿è¡Œï¼‰
2. åœ¨ IDEA ä¸­é‡æ–°å¯åŠ¨åç«¯
3. åç«¯ä¼šè‡ªåŠ¨ä»ç³»ç»Ÿç¯å¢ƒå˜é‡è¯»å– API Key

### 4.4 å¯ç”¨æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
| --- | --- | --- |
| `POST /api/auth/register` | åˆ›å»ºè´¦å·ï¼ˆaccount + passwordï¼‰ |
| `POST /api/auth/login` | ç™»å½•ï¼Œè¿”å› `token` ä¸ `userId` |
| `GET /api/chat/conversations` | è·å–å½“å‰ç”¨æˆ·çš„ä¼šè¯åˆ—è¡¨ï¼ˆéœ€è¦ `Authorization: Bearer <token>`ï¼‰ |
| `POST /api/chat/send` | å‘æ‰€é€‰æ¨¡å‹å‘é€æ¶ˆæ¯ï¼ŒåŒæ—¶å†™å…¥ä¼šè¯ä¸æ¶ˆæ¯è¡¨ |

æ‰€æœ‰æ¥å£éƒ½è¿”å›ç»Ÿä¸€çš„ `ApiResponse<T>`ï¼ŒAndroid ä¾§å·²ç»é€‚é…ã€‚

### 4.5 ä¸ Android è”è°ƒ

1. å¯åŠ¨åç«¯ï¼ˆé»˜è®¤ç«¯å£ 8081ï¼‰
2. ç¡®ä¿æ¨¡æ‹Ÿå™¨å¯è®¿é—®ä¸»æœºï¼ŒAndroid ç«¯ `RetrofitClient` å·²è®¾ç½® `http://10.0.2.2:8081/`
3. åœ¨ App å†…ç‚¹å‡»æ³¨å†Œæˆ–ç™»å½•ï¼ŒæˆåŠŸåä¼šå°† Token å†™å…¥ `SessionManager`
4. èŠå¤©/å†å²é¡µé¢å³å¯å®æ—¶è°ƒç”¨åç«¯

> ç”Ÿäº§éƒ¨ç½²æ—¶å¯å°† `DreamAIChat_backend` æ‰“åŒ…ä¸º Jarï¼š`./gradlew bootJar`ï¼Œä¸Šä¼ è‡³æœåŠ¡å™¨åè¿è¡Œ `java -jar build/libs/DreamAIChat_backend-0.1.0.jar`ï¼Œå¹¶é€šè¿‡ `application.yml` æˆ–ç¯å¢ƒå˜é‡è¦†ç›–ç«¯å£ã€æ•°æ®åº“ç­‰é…ç½®ã€‚

### 4.6 å¤§æ¨¡å‹ API Key ç”³è¯·ä¸é…ç½®

#### 4.6.1 ç”³è¯· API Key

**DeepSeek API Key**ï¼š
1. è®¿é—® https://platform.deepseek.com/
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. è¿›å…¥ **"API Keys"** é¡µé¢
4. ç‚¹å‡» **"Create API Key"**ï¼Œå¤åˆ¶ç”Ÿæˆçš„ Keyï¼ˆæ ¼å¼ï¼š`sk-xxxxx`ï¼‰

**è±†åŒ… API Key**ï¼š
1. è®¿é—® https://www.volcengine.com/
2. æ³¨å†Œ/ç™»å½•è´¦å·
3. æœç´¢å¹¶å¼€é€š **"è±†åŒ…"** æœåŠ¡
4. åœ¨ **"API å¯†é’¥ç®¡ç†"** ä¸­åˆ›å»ºå¯†é’¥ï¼Œå¤åˆ¶ç”Ÿæˆçš„ Key

#### 4.6.2 é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡

1. æŒ‰ `Win + R`ï¼Œè¾“å…¥ `sysdm.cpl`ï¼Œå›è½¦
2. ç‚¹å‡» **"é«˜çº§"** â†’ **"ç¯å¢ƒå˜é‡"**
3. åœ¨ **"ç”¨æˆ·å˜é‡"** åŒºåŸŸç‚¹å‡» **"æ–°å»º"**ï¼š
   - å˜é‡åï¼š`DEEPSEEK_API_KEY`ï¼Œå˜é‡å€¼ï¼šä½ çš„ DeepSeek API Key
   - å˜é‡åï¼š`DOUBAO_API_KEY`ï¼Œå˜é‡å€¼ï¼šä½ çš„è±†åŒ… API Key
4. ç‚¹å‡» **"ç¡®å®š"** ä¿å­˜
5. **é‡è¦**ï¼šå…³é—­æ‰€æœ‰å·²æ‰“å¼€çš„ç»ˆç«¯/IDEA çª—å£ï¼Œé‡æ–°æ‰“å¼€ IDEA

#### 4.6.3 åœ¨ IDEA ä¸­é…ç½®ç¯å¢ƒå˜é‡

1. åœ¨ IDEA è¿è¡Œé…ç½®çš„ **"Environment variables"** ä¸­æ·»åŠ ï¼š
   ```
   DEEPSEEK_API_KEY=${DEEPSEEK_API_KEY}
   DOUBAO_API_KEY=${DOUBAO_API_KEY}
   ```
2. æˆ–è€…ç›´æ¥å¡«å†™å®é™…å€¼ï¼ˆä¸æ¨èï¼‰

#### 4.6.4 éªŒè¯é…ç½®

1. åœ¨ IDEA ä¸­å¯åŠ¨åç«¯
2. åœ¨ Android åº”ç”¨ä¸­å‘é€æµ‹è¯•æ¶ˆæ¯
3. å¦‚æœæ”¶åˆ°çœŸå®çš„ AI å›å¤ï¼ˆä¸æ˜¯æ¼”ç¤ºæ¨¡å¼ï¼‰ï¼Œè¯´æ˜é…ç½®æˆåŠŸ âœ…

**æ³¨æ„**ï¼š
- æ¨¡å‹åç§°å¿…é¡»ä¸ç«å±±å¼•æ“æ§åˆ¶å°ä¸­çš„åç§°å®Œå…¨ä¸€è‡´ï¼ˆè±†åŒ…ï¼š`doubao-seed-1-6-vision-250815`ï¼‰
- å¦‚æœä¿®æ”¹æ¨¡å‹åç§°ï¼Œéœ€è¦ç¡®ä¿æ–°æ¨¡å‹åœ¨ä½ çš„è´¦æˆ·ä¸­å¯ç”¨
- è¯¦ç»†é—®é¢˜æ’æŸ¥è¯·å‚è€ƒ `vibe_codingå®è·µæ–‡æ¡£/æ•…éšœæ’æŸ¥åŠè§£å†³æ–‡æ¡£.md`


### 3.4 é…ç½®æ•°æ®åº“

#### 3.4.1 ä»€ä¹ˆæ˜¯ Room æ•°æ®åº“ï¼Ÿ

**ç®€å•ç†è§£**ï¼š
- Room æ˜¯ Android å®˜æ–¹æä¾›çš„æ•°æ®åº“æ¡†æ¶ï¼ŒåŸºäº SQLite
- å°±åƒ Excel è¡¨æ ¼ä¸€æ ·ï¼Œç”¨æ¥å­˜å‚¨åº”ç”¨çš„æ•°æ®ï¼ˆç”¨æˆ·ä¿¡æ¯ã€èŠå¤©è®°å½•ç­‰ï¼‰
- æ•°æ®ä¼šä¿å­˜åœ¨æ‰‹æœºæœ¬åœ°ï¼Œå³ä½¿å…³é—­åº”ç”¨ä¹Ÿä¸ä¼šä¸¢å¤±

**æ•°æ®åº“ç»“æ„**ï¼š
- **users è¡¨**ï¼šå­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼ˆè´¦å·ã€å¯†ç ã€ç”¨æˆ·åç­‰ï¼‰
- **conversations è¡¨**ï¼šå­˜å‚¨ä¼šè¯ä¿¡æ¯ï¼ˆå¯¹è¯æ ‡é¢˜ã€ä½¿ç”¨çš„æ¨¡å‹ç­‰ï¼‰
- **messages è¡¨**ï¼šå­˜å‚¨æ¶ˆæ¯å†…å®¹ï¼ˆç”¨æˆ·æ¶ˆæ¯ã€AIå›å¤ç­‰ï¼‰

**æ•°æ®å…³ç³»**ï¼š
```
ç”¨æˆ· (users)
  â””â”€â”€ ä¼šè¯ (conversations) - ä¸€ä¸ªç”¨æˆ·å¯ä»¥æœ‰å¤šä¸ªä¼šè¯
        â””â”€â”€ æ¶ˆæ¯ (messages) - ä¸€ä¸ªä¼šè¯å¯ä»¥æœ‰å¤šæ¡æ¶ˆæ¯
```

#### 3.4.2 æ•°æ®åº“æ–‡ä»¶ä½ç½®

**æ•°æ®åº“æ–‡ä»¶ä½ç½®**ï¼š
- åº”ç”¨é¦–æ¬¡è¿è¡Œåï¼Œæ•°æ®åº“æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ›å»º
- ä½ç½®ï¼š`/data/data/com.example.dreamaichat_app/databases/dreamai_chat.db`
- è¿™æ˜¯åº”ç”¨ç§æœ‰ç›®å½•ï¼Œå…¶ä»–åº”ç”¨æ— æ³•è®¿é—®

**å¦‚ä½•æŸ¥çœ‹æ•°æ®åº“æ–‡ä»¶**ï¼ˆå¼€å‘è°ƒè¯•ï¼‰ï¼š
1. ä½¿ç”¨ Android Studio çš„ Device File Explorer
   - ç‚¹å‡» `View` â†’ `Tool Windows` â†’ `Device File Explorer`
   - å¯¼èˆªåˆ° `/data/data/com.example.dreamaichat_app/databases/`
   - å¯ä»¥çœ‹åˆ° `dreamai_chat.db` æ–‡ä»¶

2. ä½¿ç”¨ ADB å‘½ä»¤ï¼ˆéœ€è¦ root æƒé™ï¼‰
   ```bash
   adb shell
   run-as com.example.dreamaichat_app
   cd databases
   ls
   ```

#### 3.4.3 æ•°æ®åº“é…ç½®è¯´æ˜

**æ­¥éª¤ 1ï¼šæ£€æŸ¥æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å·²åˆ›å»º**

æ•°æ®åº“æ–‡ä»¶åœ¨ä»¥ä¸‹ä½ç½®ï¼š
```
app/src/main/java/com/example/dreamaichat_app/data/database/AppDatabase.java
```

**æ­¥éª¤ 2ï¼šäº†è§£æ•°æ®åº“é…ç½®**

æ‰“å¼€ `AppDatabase.java`ï¼Œä½ ä¼šçœ‹åˆ°ä»¥ä¸‹é…ç½®ï¼š

```java
@Database(
    entities = {
        UserEntity.class,        // ç”¨æˆ·è¡¨
        ConversationEntity.class, // ä¼šè¯è¡¨
        MessageEntity.class      // æ¶ˆæ¯è¡¨
    },
    version = 1,  // æ•°æ®åº“ç‰ˆæœ¬å·
    exportSchema = false
)
```

**é‡è¦é…ç½®è¯´æ˜**ï¼š

1. **æ•°æ®åº“åç§°**ï¼š
   
   ```java
   private static final String DATABASE_NAME = "dreamai_chat.db";
   ```
   - è¿™æ˜¯æ•°æ®åº“æ–‡ä»¶å
   - å¯ä»¥ä¿®æ”¹ä¸ºä½ æƒ³è¦çš„åç§°ï¼ˆå¦‚ `my_chat.db`ï¼‰
   - ä¿®æ”¹åï¼Œæ—§æ•°æ®åº“ä¼šè¢«åˆ é™¤ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
   
2. **æ•°æ®åº“ç‰ˆæœ¬**ï¼š
   ```java
   version = 1
   ```
   - æ¯æ¬¡ä¿®æ”¹è¡¨ç»“æ„ï¼ˆæ·»åŠ å­—æ®µã€åˆ é™¤è¡¨ç­‰ï¼‰æ—¶ï¼Œéœ€è¦é€’å¢ç‰ˆæœ¬å·
   - ä¾‹å¦‚ï¼šç¬¬ä¸€æ¬¡ä¿®æ”¹åæ”¹ä¸º `version = 2`
   - ç”Ÿäº§ç¯å¢ƒéœ€è¦å®ç° `Migration` ç±»æ¥è¿ç§»æ•°æ®

3. **å¼€å‘ç¯å¢ƒé…ç½®**ï¼š
   ```java
   .fallbackToDestructiveMigration()  // ç‰ˆæœ¬å‡çº§æ—¶åˆ é™¤æ—§æ•°æ®
   .allowMainThreadQueries()          // å…è®¸åœ¨ä¸»çº¿ç¨‹æŸ¥è¯¢
   ```
   - **æ³¨æ„**ï¼šè¿™äº›é…ç½®ä»…ç”¨äºå¼€å‘ç¯å¢ƒ
   - ç”Ÿäº§ç¯å¢ƒéœ€è¦ç§»é™¤ `allowMainThreadQueries()`ï¼Œå¹¶ä½¿ç”¨åå°çº¿ç¨‹

#### 3.4.4 æ•°æ®åº“åˆå§‹åŒ–æµç¨‹

**é¦–æ¬¡è¿è¡Œåº”ç”¨æ—¶**ï¼š

1. **åº”ç”¨å¯åŠ¨** â†’ è°ƒç”¨ `AppDatabase.getInstance(context)`
2. **Room æ¡†æ¶æ£€æŸ¥** â†’ æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Ÿ
   - å¦‚æœä¸å­˜åœ¨ â†’ åˆ›å»ºæ•°æ®åº“æ–‡ä»¶
   - å¦‚æœå­˜åœ¨ â†’ æ£€æŸ¥ç‰ˆæœ¬å·æ˜¯å¦åŒ¹é…
3. **åˆ›å»ºè¡¨ç»“æ„** â†’ æ ¹æ® `@Entity` æ³¨è§£è‡ªåŠ¨åˆ›å»ºè¡¨
4. **æ•°æ®åº“å°±ç»ª** â†’ å¯ä»¥å¼€å§‹ä½¿ç”¨

**æ•°æ®åº“è¡¨ç»“æ„**ï¼š

**users è¡¨**ï¼š
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | Long | ç”¨æˆ·IDï¼ˆä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰|
| account | String | ç”¨æˆ·è´¦å·ï¼ˆæ‰‹æœºå·æˆ–é‚®ç®±ï¼‰|
| password | String | å¯†ç ï¼ˆåŠ å¯†åï¼‰|
| username | String | ç”¨æˆ·å |
| avatarUrl | String | å¤´åƒURL |
| memberType | String | ä¼šå‘˜ç±»å‹ï¼ˆfree/premiumï¼‰|
| token | String | ç™»å½•Token |
| tokenExpireTime | Long | Tokenè¿‡æœŸæ—¶é—´ |
| createdAt | Long | åˆ›å»ºæ—¶é—´ |
| updatedAt | Long | æ›´æ–°æ—¶é—´ |

**conversations è¡¨**ï¼š
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | Long | ä¼šè¯IDï¼ˆä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰|
| userId | Long | ç”¨æˆ·IDï¼ˆå¤–é”®ï¼‰|
| title | String | ä¼šè¯æ ‡é¢˜ |
| model | String | ä½¿ç”¨çš„AIæ¨¡å‹ |
| messageCount | Integer | æ¶ˆæ¯æ€»æ•° |
| isFavorite | Boolean | æ˜¯å¦æ”¶è— |
| lastMessagePreview | String | æœ€åæ¶ˆæ¯é¢„è§ˆ |
| lastMessageTime | Long | æœ€åæ¶ˆæ¯æ—¶é—´ |
| createdAt | Long | åˆ›å»ºæ—¶é—´ |
| updatedAt | Long | æ›´æ–°æ—¶é—´ |

**messages è¡¨**ï¼š
| å­—æ®µå | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| id | Long | æ¶ˆæ¯IDï¼ˆä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰|
| conversationId | Long | ä¼šè¯IDï¼ˆå¤–é”®ï¼‰|
| role | String | æ¶ˆæ¯ç±»å‹ï¼ˆuser/assistant/systemï¼‰|
| content | String | æ¶ˆæ¯å†…å®¹ |
| status | String | æ¶ˆæ¯çŠ¶æ€ï¼ˆsending/success/failedï¼‰|
| errorMessage | String | é”™è¯¯ä¿¡æ¯ |
| createdAt | Long | åˆ›å»ºæ—¶é—´ |
| updatedAt | Long | æ›´æ–°æ—¶é—´ |

#### 3.4.5 å¦‚ä½•ä½¿ç”¨æ•°æ®åº“

**åœ¨ä»£ç ä¸­ä½¿ç”¨æ•°æ®åº“**ï¼š

1. **è·å– Repository å®ä¾‹**ï¼š
   ```java
   UserRepository userRepository = new UserRepository(context);
   ```

2. **æ’å…¥æ•°æ®**ï¼š
   ```java
   UserEntity user = new UserEntity("user@example.com", "password", "ç”¨æˆ·å");
   userRepository.insertOrUpdateUser(user)
       .subscribe(
           () -> Log.d("Database", "ç”¨æˆ·ä¿å­˜æˆåŠŸ"),
           error -> Log.e("Database", "ä¿å­˜å¤±è´¥", error)
       );
   ```

3. **æŸ¥è¯¢æ•°æ®**ï¼š
   ```java
   userRepository.getUserByAccount("user@example.com")
       .subscribe(
           user -> Log.d("Database", "æ‰¾åˆ°ç”¨æˆ·: " + user.username),
           error -> Log.e("Database", "æŸ¥è¯¢å¤±è´¥", error)
       );
   ```

#### 3.4.6 æ•°æ®åº“è¿ç§»ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

**ä»€ä¹ˆæ—¶å€™éœ€è¦è¿ç§»**ï¼š
- ä¿®æ”¹äº†è¡¨ç»“æ„ï¼ˆæ·»åŠ å­—æ®µã€åˆ é™¤å­—æ®µã€ä¿®æ”¹å­—æ®µç±»å‹ï¼‰
- éœ€è¦ä¿ç•™æ—§æ•°æ®

**è¿ç§»æ­¥éª¤**ï¼š

1. **å¢åŠ æ•°æ®åº“ç‰ˆæœ¬å·**ï¼š
   ```java
   @Database(..., version = 2)  // ä» 1 æ”¹ä¸º 2
   ```

2. **åˆ›å»º Migration ç±»**ï¼š
   ```java
   static final Migration MIGRATION_1_2 = new Migration(1, 2) {
       @Override
       public void migrate(SupportSQLiteDatabase database) {
           // æ·»åŠ æ–°å­—æ®µ
           database.execSQL("ALTER TABLE users ADD COLUMN nickname TEXT");
       }
   };
   ```

3. **åº”ç”¨ Migration**ï¼š
   ```java
   .addMigrations(MIGRATION_1_2)
   ```

#### 3.4.7 éªŒè¯æ•°æ®åº“æ˜¯å¦æ­£å¸¸å·¥ä½œ

**æ–¹æ³• 1ï¼šæŸ¥çœ‹æ—¥å¿—**

è¿è¡Œåº”ç”¨åï¼Œåœ¨ Logcat ä¸­æœç´¢ "Database" æˆ– "Room"ï¼š
- å¦‚æœçœ‹åˆ° "æ•°æ®åº“åˆ›å»ºæˆåŠŸ" æˆ–ç±»ä¼¼æ—¥å¿—ï¼Œè¯´æ˜æ•°æ®åº“æ­£å¸¸
- å¦‚æœçœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼Œæ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®

**æ–¹æ³• 2ï¼šæµ‹è¯•æ•°æ®æ“ä½œ**

åœ¨ä»£ç ä¸­æ·»åŠ æµ‹è¯•ä»£ç ï¼š
```java
// æµ‹è¯•æ’å…¥ç”¨æˆ·
UserRepository repository = new UserRepository(context);
UserEntity testUser = new UserEntity("test@example.com", "123456", "æµ‹è¯•ç”¨æˆ·");
repository.insertOrUpdateUser(testUser)
    .subscribe(
        () -> Log.d("Test", "âœ… æ•°æ®åº“æµ‹è¯•æˆåŠŸ"),
        error -> Log.e("Test", "âŒ æ•°æ®åº“æµ‹è¯•å¤±è´¥", error)
    );
```

**æ–¹æ³• 3ï¼šä½¿ç”¨æ•°æ®åº“æŸ¥çœ‹å·¥å…·**

1. å¯¼å‡ºæ•°æ®åº“æ–‡ä»¶åˆ°ç”µè„‘
2. ä½¿ç”¨ SQLite æŸ¥çœ‹å·¥å…·ï¼ˆå¦‚ DB Browser for SQLiteï¼‰æ‰“å¼€
3. æŸ¥çœ‹è¡¨ç»“æ„å’Œæ•°æ®

#### 3.4.8 å¸¸è§é—®é¢˜

**é—®é¢˜ 1ï¼šæ•°æ®åº“æ–‡ä»¶æœªåˆ›å»º**

**åŸå› **ï¼š
- åº”ç”¨æœªè¿è¡Œ
- æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®ä¿åº”ç”¨å·²è¿è¡Œè‡³å°‘ä¸€æ¬¡
2. æ£€æŸ¥ `AppDatabase.java` ä¸­çš„é…ç½®æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ Logcat ä¸­çš„é”™è¯¯ä¿¡æ¯

**é—®é¢˜ 2ï¼šRoom ç¼–è¯‘é”™è¯¯**

**åŸå› **ï¼š
- ç¼ºå°‘ `kapt` æ’ä»¶
- `room-compiler` ä¾èµ–æœªæ­£ç¡®é…ç½®

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `app/build.gradle.kts` ä¸­æ˜¯å¦åŒ…å«ï¼š
   ```kotlin
   plugins {
       alias(libs.plugins.kotlin.kapt)
   }
   dependencies {
       kapt(libs.room.compiler)
   }
   ```
2. åŒæ­¥ Gradleï¼š`File` â†’ `Sync Project with Gradle Files`
3. æ¸…ç†é¡¹ç›®ï¼š`Build` â†’ `Clean Project`

**é—®é¢˜ 3ï¼šæ•°æ®ä¸¢å¤±**

**åŸå› **ï¼š
- ä½¿ç”¨äº† `fallbackToDestructiveMigration()`
- æ•°æ®åº“ç‰ˆæœ¬å·æ”¹å˜

**è§£å†³æ–¹æ³•**ï¼š
- å¼€å‘ç¯å¢ƒï¼šè¿™æ˜¯æ­£å¸¸è¡Œä¸ºï¼Œæ•°æ®ä¼šè¢«æ¸…ç©º
- ç”Ÿäº§ç¯å¢ƒï¼šå®ç° `Migration` ç±»æ¥ä¿ç•™æ•°æ®

**é—®é¢˜ 4ï¼šæŸ¥è¯¢è¿”å›ç©ºæ•°æ®**

**åŸå› **ï¼š
- æ•°æ®æœªæ’å…¥
- æŸ¥è¯¢æ¡ä»¶é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥æ•°æ®æ˜¯å¦å·²æ’å…¥ï¼ˆä½¿ç”¨æ•°æ®åº“æŸ¥çœ‹å·¥å…·ï¼‰
2. æ£€æŸ¥æŸ¥è¯¢æ¡ä»¶æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ Logcat ä¸­çš„æŸ¥è¯¢æ—¥å¿—

#### 3.4.9 æ•°æ®åº“æœ€ä½³å®è·µ

1. **ä½¿ç”¨åå°çº¿ç¨‹**ï¼š
   - ç”Ÿäº§ç¯å¢ƒå¿…é¡»åœ¨åå°çº¿ç¨‹æ‰§è¡Œæ•°æ®åº“æ“ä½œ
   - ä½¿ç”¨ RxJava çš„ `subscribeOn(Schedulers.io())`

2. **åŠæ—¶å…³é—­è¿æ¥**ï¼š
   - åº”ç”¨é€€å‡ºæ—¶è°ƒç”¨ `AppDatabase.closeDatabase()`
   - é¿å…å†…å­˜æ³„æ¼

3. **æ•°æ®å¤‡ä»½**ï¼š
   - å®šæœŸå¤‡ä»½é‡è¦æ•°æ®
   - ä½¿ç”¨ Room çš„å¯¼å‡ºåŠŸèƒ½

4. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - ä½¿ç”¨ç´¢å¼•åŠ é€ŸæŸ¥è¯¢ï¼ˆå·²åœ¨ Entity ä¸­å®šä¹‰ï¼‰
   - é¿å…åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ
   - ä½¿ç”¨æ‰¹é‡æ’å…¥æé«˜æ•ˆç‡

#### 3.4.10 ä¸‹ä¸€æ­¥

é…ç½®å®Œæ•°æ®åº“åï¼š
1. âœ… è¿è¡Œåº”ç”¨ï¼Œç¡®è®¤æ•°æ®åº“æ–‡ä»¶å·²åˆ›å»º
2. âœ… æµ‹è¯•æ•°æ®æ’å…¥å’ŒæŸ¥è¯¢åŠŸèƒ½
3. âœ… æŸ¥çœ‹ Logcat ç¡®è®¤æ²¡æœ‰é”™è¯¯
4. âœ… ç»§ç»­å¼€å‘å…¶ä»–åŠŸèƒ½

## 4. æ„å»ºé¡¹ç›®

### 4.1 ä½¿ç”¨ Android Studio

1. **é€‰æ‹©æ„å»ºå˜ä½“**
   - ç‚¹å‡» `Build` â†’ `Select Build Variant`
   - é€‰æ‹© `debug` æˆ– `release`

2. **æ„å»º APK**
   - ç‚¹å‡» `Build` â†’ `Build Bundle(s) / APK(s)` â†’ `Build APK(s)`
   - æ„å»ºå®Œæˆåï¼ŒAPK ä½äº `app/build/outputs/apk/`

3. **è¿è¡Œåº”ç”¨**
   - è¿æ¥ Android è®¾å¤‡æˆ–å¯åŠ¨æ¨¡æ‹Ÿå™¨
   - ç‚¹å‡» `Run` â†’ `Run 'app'` æˆ–æŒ‰ `Shift + F10`

### 4.2 ä½¿ç”¨å‘½ä»¤è¡Œ

#### Windows

```powershell
# æ¸…ç†æ„å»º
.\gradlew clean

# æ„å»º Debug APK
.\gradlew assembleDebug

# æ„å»º Release APK
.\gradlew assembleRelease

# å®‰è£…åˆ°è®¾å¤‡
.\gradlew installDebug
```

#### macOS/Linux

```bash
# æ¸…ç†æ„å»º
./gradlew clean

# æ„å»º Debug APK
./gradlew assembleDebug

# æ„å»º Release APK
./gradlew assembleRelease

# å®‰è£…åˆ°è®¾å¤‡
./gradlew installDebug
```

## 5. è¿è¡Œåº”ç”¨

### 5.1 åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ

1. **åˆ›å»ºæ¨¡æ‹Ÿå™¨**
   - æ‰“å¼€ `Tools` â†’ `Device Manager`
   - ç‚¹å‡» `Create Device`
   - é€‰æ‹©è®¾å¤‡å‹å·å’Œç³»ç»Ÿé•œåƒï¼ˆAPI 21+ï¼‰
   - å®Œæˆåˆ›å»º

2. **è¿è¡Œåº”ç”¨**
   - é€‰æ‹©åˆ›å»ºçš„æ¨¡æ‹Ÿå™¨
   - ç‚¹å‡» `Run` æŒ‰é’®

### 5.2 åœ¨çœŸæœºä¸Šè¿è¡Œ

1. **å¯ç”¨å¼€å‘è€…é€‰é¡¹**
   - æ‰“å¼€è®¾å¤‡ `è®¾ç½®` â†’ `å…³äºæ‰‹æœº`
   - è¿ç»­ç‚¹å‡» `ç‰ˆæœ¬å·` 7æ¬¡
   - è¿”å›è®¾ç½®ï¼Œæ‰¾åˆ° `å¼€å‘è€…é€‰é¡¹`

2. **å¯ç”¨ USB è°ƒè¯•**
   - åœ¨ `å¼€å‘è€…é€‰é¡¹` ä¸­å¯ç”¨ `USB è°ƒè¯•`
   - è¿æ¥è®¾å¤‡åˆ°ç”µè„‘

3. **è¿è¡Œåº”ç”¨**
   - Android Studio ä¼šè‡ªåŠ¨æ£€æµ‹è®¾å¤‡
   - é€‰æ‹©è®¾å¤‡å¹¶ç‚¹å‡» `Run`

## 6. å¸¸è§é—®é¢˜

### 6.1 Gradle åŒæ­¥å¤±è´¥

**é—®é¢˜**: Gradle åŒæ­¥æ—¶å‡ºç°é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥ `gradle/libs.versions.toml` ä¸­çš„ç‰ˆæœ¬å·æ˜¯å¦æ­£ç¡®
3. æ¸…ç†é¡¹ç›®: `File` â†’ `Invalidate Caches / Restart`
4. åˆ é™¤ `.gradle` æ–‡ä»¶å¤¹åé‡æ–°åŒæ­¥

### 6.2 ä¾èµ–ä¸‹è½½å¤±è´¥

**é—®é¢˜**: ä¾èµ–ä¸‹è½½è¶…æ—¶æˆ–å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. é…ç½®å›½å†…é•œåƒæºï¼ˆå¦‚é˜¿é‡Œäº‘ï¼‰
2. åœ¨ `build.gradle.kts` ä¸­æ·»åŠ é•œåƒé…ç½®:
   ```kotlin
   repositories {
       maven { url = uri("https://maven.aliyun.com/repository/public") }
       google()
       mavenCentral()
   }
   ```

### 6.3 Room ç¼–è¯‘é”™è¯¯

**é—®é¢˜**: Room æ³¨è§£å¤„ç†å™¨æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿å·²æ·»åŠ  `kotlin-kapt` æ’ä»¶
2. ç¡®ä¿ `room-compiler` ä¾èµ–å·²æ­£ç¡®é…ç½®
3. æ¸…ç†å¹¶é‡æ–°æ„å»ºé¡¹ç›®

### 6.4 ViewBinding ä¸å·¥ä½œ

**é—®é¢˜**: ViewBinding ç”Ÿæˆçš„ç±»æ‰¾ä¸åˆ°

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ `buildFeatures { viewBinding = true }` å·²é…ç½®
2. æ¸…ç†å¹¶é‡æ–°æ„å»ºé¡¹ç›®
3. æ£€æŸ¥å¸ƒå±€æ–‡ä»¶åç§°æ˜¯å¦æ­£ç¡®ï¼ˆä¸èƒ½ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼‰

### 6.5 ç½‘ç»œè¯·æ±‚å¤±è´¥

**é—®é¢˜**: API è¯·æ±‚è¿”å›é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `RetrofitClient` ä¸­çš„ `BASE_URL` æ˜¯å¦æ­£ç¡®
2. æ£€æŸ¥ç½‘ç»œæƒé™æ˜¯å¦å·²æ·»åŠ ï¼ˆAndroidManifest.xmlï¼‰
3. æ£€æŸ¥ API æœåŠ¡å™¨æ˜¯å¦å¯è®¿é—®
4. æŸ¥çœ‹ Logcat ä¸­çš„é”™è¯¯ä¿¡æ¯

## 7. å›¾ç‰‡èµ„æºé…ç½®

### 7.1 åº”ç”¨å›¾æ ‡ä½ç½®

åº”ç”¨å›¾æ ‡éœ€è¦æ”¾åœ¨ä»¥ä¸‹ç›®å½•ä¸­ï¼Œæ¯ä¸ªå¯†åº¦éƒ½éœ€è¦æä¾›å¯¹åº”å°ºå¯¸çš„å›¾æ ‡ï¼š

**é¡¹ç›®è·¯å¾„**: `app/src/main/res/`

#### 7.1.1 åº”ç”¨å¯åŠ¨å›¾æ ‡ (mipmap ç›®å½•)

åº”ç”¨å¯åŠ¨å›¾æ ‡éœ€è¦æ”¾åœ¨ä»¥ä¸‹ç›®å½•ï¼Œæ¯ä¸ªç›®å½•å¯¹åº”ä¸åŒçš„å±å¹•å¯†åº¦ï¼š

1. **mipmap-mdpi/** (48x48 dp)
   - æ–‡ä»¶: `ic_launcher.png` å’Œ `ic_launcher_round.png`
   - å®é™…å°ºå¯¸: 48x48 åƒç´ 
   - å®Œæ•´è·¯å¾„: `app/src/main/res/mipmap-mdpi/ic_launcher.png`

2. **mipmap-hdpi/** (72x72 dp)
   - æ–‡ä»¶: `ic_launcher.png` å’Œ `ic_launcher_round.png`
   - å®é™…å°ºå¯¸: 72x72 åƒç´ 
   - å®Œæ•´è·¯å¾„: `app/src/main/res/mipmap-hdpi/ic_launcher.png`

3. **mipmap-xhdpi/** (96x96 dp)
   - æ–‡ä»¶: `ic_launcher.png` å’Œ `ic_launcher_round.png`
   - å®é™…å°ºå¯¸: 96x96 åƒç´ 
   - å®Œæ•´è·¯å¾„: `app/src/main/res/mipmap-xhdpi/ic_launcher.png`

4. **mipmap-xxhdpi/** (144x144 dp)
   - æ–‡ä»¶: `ic_launcher.png` å’Œ `ic_launcher_round.png`
   - å®é™…å°ºå¯¸: 144x144 åƒç´ 
   - å®Œæ•´è·¯å¾„: `app/src/main/res/mipmap-xxhdpi/ic_launcher.png`

5. **mipmap-xxxhdpi/** (192x192 dp)
   - æ–‡ä»¶: `ic_launcher.png` å’Œ `ic_launcher_round.png`
   - å®é™…å°ºå¯¸: 192x192 åƒç´ 
   - å®Œæ•´è·¯å¾„: `app/src/main/res/mipmap-xxxhdpi/ic_launcher.png`

6. **mipmap-anydpi-v26/** (è‡ªé€‚åº”å›¾æ ‡ï¼ŒAndroid 8.0+)
   - æ–‡ä»¶: `ic_launcher.xml` å’Œ `ic_launcher_round.xml`
   - è¿™äº›æ˜¯ XML æ–‡ä»¶ï¼Œå®šä¹‰äº†è‡ªé€‚åº”å›¾æ ‡çš„èƒŒæ™¯å’Œå‰æ™¯
   - å®Œæ•´è·¯å¾„: `app/src/main/res/mipmap-anydpi-v26/ic_launcher.xml`

#### 7.1.2 è‡ªé€‚åº”å›¾æ ‡èµ„æº (drawable ç›®å½•)

è‡ªé€‚åº”å›¾æ ‡éœ€è¦ä»¥ä¸‹èµ„æºæ–‡ä»¶ï¼š

1. **drawable/ic_launcher_background.xml**
   - å®Œæ•´è·¯å¾„: `app/src/main/res/drawable/ic_launcher_background.xml`
   - è¿™æ˜¯å›¾æ ‡çš„èƒŒæ™¯å±‚ï¼ˆé€šå¸¸æ˜¯çº¯è‰²æˆ–æ¸å˜ï¼‰

2. **drawable-v24/ic_launcher_foreground.xml**
   - å®Œæ•´è·¯å¾„: `app/src/main/res/drawable-v24/ic_launcher_foreground.xml`
   - è¿™æ˜¯å›¾æ ‡çš„å‰æ™¯å±‚ï¼ˆé€šå¸¸æ˜¯åº”ç”¨ Logoï¼‰

### 7.2 å¦‚ä½•æ›¿æ¢åº”ç”¨å›¾æ ‡

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Android Studio çš„ Image Asset Studioï¼ˆæ¨èï¼‰

1. åœ¨ Android Studio ä¸­ï¼Œå³é”®ç‚¹å‡» `res` æ–‡ä»¶å¤¹
2. é€‰æ‹© `New` â†’ `Image Asset`
3. åœ¨ `Icon Type` ä¸­é€‰æ‹© `Launcher Icons (Adaptive and Legacy)`
4. é€‰æ‹©ä½ çš„å›¾æ ‡å›¾ç‰‡ï¼ˆå»ºè®®ä½¿ç”¨ 1024x1024 åƒç´ çš„ PNG å›¾ç‰‡ï¼‰
5. è°ƒæ•´å‰æ™¯å’ŒèƒŒæ™¯
6. ç‚¹å‡» `Next` â†’ `Finish`
7. Android Studio ä¼šè‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰éœ€è¦çš„å›¾æ ‡æ–‡ä»¶

#### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨æ›¿æ¢

1. **å‡†å¤‡å›¾æ ‡æ–‡ä»¶**
   - å‡†å¤‡ä¸€ä¸ª 1024x1024 åƒç´ çš„ PNG å›¾æ ‡ï¼ˆé€æ˜èƒŒæ™¯ï¼‰
   - ä½¿ç”¨åœ¨çº¿å·¥å…·ï¼ˆå¦‚ [Android Asset Studio](https://romannurik.github.io/AndroidAssetStudio/icons-launcher.html)ï¼‰ç”Ÿæˆä¸åŒå¯†åº¦çš„å›¾æ ‡

2. **æ›¿æ¢æ–‡ä»¶**
   - å°†ç”Ÿæˆçš„å›¾æ ‡æ–‡ä»¶å¤åˆ¶åˆ°å¯¹åº”çš„ `mipmap-*` ç›®å½•
   - ç¡®ä¿æ–‡ä»¶åæ­£ç¡®ï¼š`ic_launcher.png` å’Œ `ic_launcher_round.png`

3. **æ›´æ–°è‡ªé€‚åº”å›¾æ ‡**ï¼ˆå¯é€‰ï¼ŒAndroid 8.0+ï¼‰
   - ç¼–è¾‘ `drawable/ic_launcher_background.xml` è®¾ç½®èƒŒæ™¯è‰²
   - ç¼–è¾‘ `drawable-v24/ic_launcher_foreground.xml` è®¾ç½®å‰æ™¯å›¾æ ‡

### 7.3 å…¶ä»–å›¾ç‰‡èµ„æºä½ç½®

#### 7.3.1 Drawable èµ„æº

ç”¨äºç•Œé¢ä¸­çš„å›¾æ ‡ã€æŒ‰é’®èƒŒæ™¯ç­‰ï¼š

- **ä½ç½®**: `app/src/main/res/drawable/`
- **æ”¯æŒæ ¼å¼**: PNG, JPG, XML (Vector Drawable), WebP
- **å‘½åè§„åˆ™**: å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œä¸èƒ½ä»¥æ•°å­—å¼€å¤´
- **ç¤ºä¾‹**: 
  - `app/src/main/res/drawable/ic_menu.png`
  - `app/src/main/res/drawable/button_background.xml`

#### 7.3.2 ä¸åŒå¯†åº¦çš„ Drawable

å¦‚æœéœ€è¦ä¸ºä¸åŒå±å¹•å¯†åº¦æä¾›ä¸åŒå°ºå¯¸çš„å›¾ç‰‡ï¼š

- **drawable-mdpi/**: ä¸­ç­‰å¯†åº¦ (160 dpi)
- **drawable-hdpi/**: é«˜å¯†åº¦ (240 dpi)
- **drawable-xhdpi/**: è¶…é«˜å¯†åº¦ (320 dpi)
- **drawable-xxhdpi/**: è¶…è¶…é«˜å¯†åº¦ (480 dpi)
- **drawable-xxxhdpi/**: è¶…è¶…è¶…é«˜å¯†åº¦ (640 dpi)

#### 7.3.3 æ¨èå›¾ç‰‡å°ºå¯¸

| ç”¨é€” | æ¨èå°ºå¯¸ | æ ¼å¼ | ä½ç½® |
|------|---------|------|------|
| åº”ç”¨å›¾æ ‡ | 1024x1024 | PNG | mipmap-* |
| ç•Œé¢å›¾æ ‡ | 24x24, 48x48 dp | PNG/SVG | drawable |
| å¯åŠ¨é¡µå›¾ç‰‡ | 1080x1920 | PNG/JPG | drawable |
| èƒŒæ™¯å›¾ç‰‡ | æ ¹æ®è®¾è®¡ | PNG/JPG/WebP | drawable |

### 7.4 å›¾ç‰‡èµ„æºä¼˜åŒ–å»ºè®®

1. **ä½¿ç”¨ WebP æ ¼å¼**: æ¯” PNG ä½“ç§¯æ›´å°ï¼Œè´¨é‡æ›´å¥½
2. **ä½¿ç”¨ Vector Drawable**: å¯¹äºç®€å•å›¾æ ‡ï¼Œä½¿ç”¨ XML æ ¼å¼çš„çŸ¢é‡å›¾
3. **å‹ç¼©å›¾ç‰‡**: ä½¿ç”¨å·¥å…·ï¼ˆå¦‚ TinyPNGï¼‰å‹ç¼©å›¾ç‰‡
4. **æŒ‰éœ€æä¾›**: åªä¸ºéœ€è¦çš„å¯†åº¦æä¾›å›¾ç‰‡ï¼Œé¿å… APK ä½“ç§¯è¿‡å¤§

## 8. XML æ–‡ä»¶é—®é¢˜æ’æŸ¥

### 8.1 "Valid XML document must have a root tag" é”™è¯¯

å¦‚æœé‡åˆ°æ­¤é”™è¯¯ï¼Œè¯·æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

1. **æ£€æŸ¥ XML æ–‡ä»¶æ˜¯å¦å®Œæ•´**
   - ç¡®ä¿æ¯ä¸ª XML æ–‡ä»¶éƒ½æœ‰æ­£ç¡®çš„æ ¹æ ‡ç­¾
   - ç¡®ä¿ XML æ–‡ä»¶æ²¡æœ‰è¢«æˆªæ–­

2. **å¸¸è§é—®é¢˜æ–‡ä»¶**
   - `app/src/main/res/xml/data_extraction_rules.xml`
   - `app/src/main/res/xml/backup_rules.xml`
   - `app/src/main/res/mipmap-anydpi-v26/ic_launcher.xml`
   - `app/src/main/res/mipmap-anydpi-v26/ic_launcher_round.xml`

3. **è§£å†³æ–¹æ³•**
   - åœ¨ Android Studio ä¸­ï¼Œé€‰æ‹© `File` â†’ `Invalidate Caches / Restart`
   - æ¸…ç†é¡¹ç›®: `Build` â†’ `Clean Project`
   - é‡æ–°æ„å»º: `Build` â†’ `Rebuild Project`

4. **éªŒè¯ XML æ–‡ä»¶**
   - ç¡®ä¿æ‰€æœ‰ XML æ–‡ä»¶éƒ½ä»¥ `<?xml version="1.0" encoding="utf-8"?>` å¼€å¤´
   - ç¡®ä¿æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ ¹å…ƒç´ 
   - ç¡®ä¿æ‰€æœ‰æ ‡ç­¾éƒ½æ­£ç¡®é—­åˆ

## 9. é…ç½®è¯´æ˜

### 9.1 ç½‘ç»œæƒé™

ç¡®ä¿ `AndroidManifest.xml` ä¸­åŒ…å«ç½‘ç»œæƒé™:

```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
```

### 9.2 åº”ç”¨é…ç½®

**åº”ç”¨ ID**: `com.example.dreamaichat_app`

å¦‚éœ€ä¿®æ”¹ï¼Œç¼–è¾‘ `app/build.gradle.kts`:
```kotlin
defaultConfig {
    applicationId = "com.yourcompany.dreamaichat_app"
    // ...
}
```

**ç‰ˆæœ¬ä¿¡æ¯**:
- Version Code: 1
- Version Name: "1.0"

### 9.3 ç­¾åé…ç½®ï¼ˆRelease æ„å»ºï¼‰

1. **ç”Ÿæˆå¯†é’¥åº“**
   ```bash
   keytool -genkey -v -keystore dreamai-release.jks -keyalg RSA -keysize 2048 -validity 10000 -alias dreamai
   ```

2. **é…ç½®ç­¾å**
   åœ¨ `app/build.gradle.kts` ä¸­æ·»åŠ :
   ```kotlin
   android {
       signingConfigs {
           create("release") {
               storeFile = file("path/to/keystore.jks")
               storePassword = "your-store-password"
               keyAlias = "dreamai"
               keyPassword = "your-key-password"
           }
       }
       buildTypes {
           release {
               signingConfig = signingConfigs.getByName("release")
               // ...
           }
       }
   }
   ```

## 10. å¼€å‘å»ºè®®

### 10.1 ä»£ç è§„èŒƒ

- éµå¾ª Java ç¼–ç è§„èŒƒ
- ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å’Œæ–¹æ³•å
- æ·»åŠ å¿…è¦çš„æ³¨é‡Š
- ä¿æŒä»£ç ç®€æ´

### 10.2 è°ƒè¯•æŠ€å·§

1. **ä½¿ç”¨ Logcat**
   - æŸ¥çœ‹åº”ç”¨æ—¥å¿—
   - è¿‡æ»¤ç‰¹å®šæ ‡ç­¾
   - æœç´¢é”™è¯¯ä¿¡æ¯

2. **ä½¿ç”¨æ–­ç‚¹**
   - åœ¨å…³é”®ä»£ç å¤„è®¾ç½®æ–­ç‚¹
   - ä½¿ç”¨è°ƒè¯•æ¨¡å¼è¿è¡Œåº”ç”¨
   - æ£€æŸ¥å˜é‡å€¼

3. **ä½¿ç”¨ Android Profiler**
   - ç›‘æ§ CPU ä½¿ç”¨
   - ç›‘æ§å†…å­˜ä½¿ç”¨
   - ç›‘æ§ç½‘ç»œè¯·æ±‚

### 10.3 æµ‹è¯•

1. **å•å…ƒæµ‹è¯•**
   - æµ‹è¯• UseCase å’Œ Repository
   - ä½¿ç”¨ JUnit å’Œ Mockito

2. **UI æµ‹è¯•**
   - ä½¿ç”¨ Espresso è¿›è¡Œ UI æµ‹è¯•
   - æµ‹è¯•å…³é”®ç”¨æˆ·æµç¨‹

## 11. å‘å¸ƒå‡†å¤‡

### 11.1 ä»£ç æ··æ·†

åœ¨ `app/proguard-rules.pro` ä¸­æ·»åŠ æ··æ·†è§„åˆ™:

```proguard
# Retrofit
-keepattributes Signature, InnerClasses
-keepattributes RuntimeVisibleAnnotations, RuntimeVisibleParameterAnnotations
-keepclassmembers,allowshrinking,allowobfuscation interface * {
    @retrofit2.http.* <methods>;
}

# Room
-keep class * extends androidx.room.RoomDatabase
-keep @androidx.room.Entity class *
```

### 11.2 èµ„æºä¼˜åŒ–

1. **ç§»é™¤æœªä½¿ç”¨çš„èµ„æº**
   ```bash
   ./gradlew clean
   ```

2. **å‹ç¼©å›¾ç‰‡èµ„æº**
   - ä½¿ç”¨ WebP æ ¼å¼
   - ä½¿ç”¨é€‚å½“çš„å›¾ç‰‡å°ºå¯¸

### 11.3 æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨ ProGuard**
   ```kotlin
   buildTypes {
       release {
           isMinifyEnabled = true
           proguardFiles(getDefaultProguardFile("proguard-android-optimize.txt"), "proguard-rules.pro")
       }
   }
   ```

2. **å¯ç”¨èµ„æºå‹ç¼©**
   ```kotlin
   buildTypes {
       release {
           isShrinkResources = true
       }
   }
   ```

## 12. åç»­æ­¥éª¤

1. **å®ç°å‰©ä½™åŠŸèƒ½**
   - å®Œå–„èŠå¤©ç•Œé¢åŠŸèƒ½
   - å®ç°å†å²è®°å½•ç®¡ç†
   - å®ç°ä¸ªäººä¸­å¿ƒåŠŸèƒ½
   - å®ç°ç‰¹è‰²åŠŸèƒ½ï¼ˆæ¨¡æ¿ã€è·¯ç”±ã€å›¾è°±ï¼‰

2. **é›†æˆç¬¬ä¸‰æ–¹æœåŠ¡**
   - å¾®ä¿¡ç™»å½• SDK
   - è‹¹æœç™»å½• SDK
   - æ¨é€æœåŠ¡

3. **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ**
   - æ·»åŠ åŠ è½½åŠ¨ç”»
   - ä¼˜åŒ–é”™è¯¯æç¤º
   - æ·»åŠ ç¦»çº¿æ”¯æŒ

4. **æµ‹è¯•å’Œä¼˜åŒ–**
   - è¿›è¡Œå…¨é¢çš„åŠŸèƒ½æµ‹è¯•
   - æ€§èƒ½ä¼˜åŒ–
   - å†…å­˜æ³„æ¼æ£€æŸ¥

## 13. æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£
2. æ£€æŸ¥ Logcat æ—¥å¿—
3. å‚è€ƒ Android å®˜æ–¹æ–‡æ¡£

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸš€

